$id: "https://gael-systems.com/drb-python"
$schema: "http://json-schema.org/draft-07/schema"
title: DRB-Python Item Class Schema Definition
description: |
  Schema definition for DRB Python item class, each item class/ implementation
  must contain a `cortex.yml` file following this schema to be correctly loaded
  by the resolver of DRB library.
definitions:
  uuid:
    type: string
    style: inline
    minLength: 36
    maxLength: 36
    pattern: '(?i)[a-f0-9]{8}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{12}'
  attribute:
    type: object
    additionalProperties: no
    properties:
      name:
        type: string
        style: inline
      namespace:
        type: string
        style: inline
      value:
        type: [boolean, number, string, 'null']
    required: [name]
  child:
    type: object
    additionalProperties: no
    properties:
      name:
        type: string
        style: inline
      namespace:
        type: string
        style: inline
      namespaceAware:
        type: boolean
    required: [name]
  signature:
    type: object
    additionalProperties: no
    properties:
      name:
        type: string
        style: inline
      namespace:
        type: string
        style: inline
      path:
        type: string
        style: inline
      attributes:
        type: array
        minItems: 1
        items: { $ref: '#/definitions/attribute'}
      children:
        type: array
        minItems: 1
        items: { $ref: '#/definitions/child' }
      parent: { $ref: '#/definitions/signature' }
      xquery:
        type: string
        style: literal
      python:
        type: string
        style: literal
    minProperties: 1
properties:
  id: { $ref: '#/definitions/uuid' }
  subClassOf: { $ref: '#/definitions/uuid' }
  label:
    type: string
  description:
    type: string
  category:
    type: string
    style: inline
    enum: [SECURITY, PROTOCOL, CONTAINER, FORMATTING]
  factory:
    type: object
    additionalProperties: no
    properties:
      name:
        type: string
        style: inline
      classpath:
        type: string
        style: inline
        pattern: '.+:.+'
    required: [name]
  signatures:
    type: array
    minItem: 1
    items: { $ref: '#/definitions/signature' }
additionalProperties: no
required: [id, label, category, signatures]