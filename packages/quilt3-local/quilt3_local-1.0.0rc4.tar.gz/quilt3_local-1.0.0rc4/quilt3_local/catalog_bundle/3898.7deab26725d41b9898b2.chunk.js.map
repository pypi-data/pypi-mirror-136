{"version":3,"file":"3898.7deab26725d41b9898b2.chunk.js","mappings":"0PAMMA,EAAMC,OAAO,OAsBNC,EAAkB,SAAC,G,IAAEC,EAAK,QAAEC,EAAI,OAAEC,EAAG,MAAEC,EAAU,aAAEC,EAAS,YACvE,OAZmB,SAACC,EAAOC,EAASJ,GACpC,YADoC,IAAAA,IAAAA,EATb,GAUnBG,GAASH,EAAY,IAAQ,EAAGG,EAAQ,GACxCC,GAAWJ,EAAM,GACZ,oBAAI,IAAQ,EAAGA,EAAM,IAAI,GAAF,CAAEL,EAAKQ,IAAK,GAExCC,GAAWD,EAAQH,EAAM,GACpB,SAAC,EAAGL,GAAQ,IAAQQ,EAAQH,EAAM,EAAGG,EAAQ,IAAE,IAEjD,kBAAC,EAAGR,GAAQ,IAAQS,EAAU,EAAGA,EAAU,IAAI,GAAF,CAAET,EAAKQ,IAAK,GAIhEE,CAAaP,EAAOC,EAAMC,GAAKM,KAAI,SAACC,EAAGC,GAAM,OAACD,IAAMZ,EAAMO,EAAUM,GAAKP,EAAWM,OAEhFE,EAAY,KAAa,SAACC,GAAM,OACpCC,OAAQ,CACNC,WAAYF,EAAEG,QAAQC,OAAOC,MAC7BC,OAAQ,GACRC,WAAY,EACZC,YAAaR,EAAES,QAAQ,KACvBC,aAAcV,EAAES,QAAQ,MAE1Bf,QAAS,CACPiB,MAAOX,EAAEG,QAAQS,QAAQC,aACzBC,gBAAiBd,EAAEG,QAAQS,QAAQG,KACnC,UAAW,CACTD,gBAAiBd,EAAEG,QAAQS,QAAQI,OAGvCC,IAAK,CACHC,OAAQ,UACRC,cAAe,YAInB,QAAe,cAAiB,SAC9B,EASAC,GARE,IAAA/B,EAAI,OACJD,EAAK,QACLiC,EAAW,cACXC,EAAQ,WACR,IAAAC,QAASC,OAAa,IAAG,KAAE,EAC3BC,EAAgB,mBACbC,GAAK,UAPV,wEAWMH,EAAUxB,IAsChB,OACE,gBAAC,KAAK,SACJ4B,QAAQ,OACRC,eAAe,SACfC,GAAI,EACJC,GAAI,CAAEC,GAAI,EAAGC,GAAI,IACbN,EAAK,CACTN,IAAKA,IAEL,gBAAC,KAAa,SAACa,QAAQ,aAAgBR,GACpCtC,EAAgB,CAAEC,MAAK,EAAEC,KAAI,EAAEG,UA9CpB,SAACM,GAAM,OACvB,gBAAC,I,CAECoC,IAAK,OAAOpC,EACZqC,UAAW,IAAGZ,EAAQtB,OAAQsB,EAAQN,IAAKO,EAAcvB,OAAQuB,EAAcP,KAC/EmB,UAAU,QAAM,MAyC6B7C,WAnC9B,SAACM,GAClB,IAAMwC,EAAK,GAQX,OAPIhB,IACFgB,EAAGD,UAAY,EAAAE,KACfD,EAAGE,GAAKlB,EAAYxB,IAElByB,IACFe,EAAGG,QAAU,WAAM,OAAAlB,EAASzB,KAG5B,gBAAC,KAAQ,SACPqC,IAAK,QAAQrC,EACbsC,UAAW,IACTZ,EAAQtB,OACRuB,EAAcvB,OACdZ,IAASQ,GAAK0B,EAAQ7B,QACtBL,IAASQ,GAAK2B,EAAc9B,UAE1B2C,GAEHxC,Y,mXC/FI4C,EAAU,IAAS,IAAT,EAAkB,SAAC,G,MAASzC,EAAC,QAAO,UACzD0C,SAAU,aACT1C,EAAE2C,YAAYC,KAAK,OAAQ,CAC1BC,aAAc,EACdC,UAAW,aAAa9C,EAAEG,QAAQ4C,QAClCC,QAAShD,EAAES,QAAQ,IAErB,EAACT,EAAE2C,YAAYM,GAAG,OAAQ,CACxBC,UAAWlD,EAAES,QAAQ,GACrBuC,QAAShD,EAAES,QAAQ,GACnB0C,WAAYnD,EAAES,QAAQ,I,KAIb2C,EAAU,IAAS,IAAT,EAAgB,SAAC,G,MAASpD,EAAC,QAAO,OAAC,oBACrDA,EAAEqD,WAAWC,MAAE,GAClB/C,WAAY,IACZgD,aAAcvD,EAAES,QAAQ,KACvBT,EAAE2C,YAAYM,GAAG,OAAQ,CACxBM,aAAcvD,EAAES,QAAQ,IACzB,EACAT,EAAE2C,YAAYM,GAAG,QAAK,WAClBjD,EAAEqD,WAAWG,IAAE,O,kICOhBC,EAAY,IAASC,EAAA,EAAT,CAAqB,CAAEC,UAAW,eAEpD,SAASC,EAAa,G,IAAEC,EAAM,SAAE,IAAAC,WAAAA,OAAU,IAAG,GAAK,EACxCC,EAASC,EAAA,KAAiB,KAC5BC,EAAQJ,EAAO3B,IAAIgC,SAAS,KAE5BC,EAAS,WAAc,WAC3B,IAAMC,GAAM,QAAeP,EAAO3B,KAC5BmC,EAAO,IAAOD,GAAKxE,KAAI,SAAC,G,IAAE0E,EAAK,QAAEC,EAAI,OAAO,OAChDhC,GAAIwB,EAAKS,WAAWX,EAAOY,OAAQF,GACnCG,SAAUJ,MAENK,EAAO,CACXpC,GAAIwB,EAAKS,WAAWX,EAAOY,OAAQZ,EAAO3B,IAAK2B,EAAOe,SACtDF,SAAU,IAAON,GAAKE,OAQxB,MAAO,CAAEG,OANMX,EACX,CACEvB,GAAIwB,EAAKc,WAAWhB,EAAOY,QAC3BC,SAAUb,EAAOY,QAEnB,KACaJ,KAAI,EAAEM,KAAI,KAC1B,CAACd,EAAQE,EAAMD,IAElB,OACE,wBAAMgB,OAAQ,MACZ,gBAACC,EAAU,CAACC,MAAOf,EAAQ,YAAc,QACtCA,EAAQ,cAAgB,qBAE1BE,EAAOM,QACN,gCACE,gBAAChB,GAAS,WAAKU,EAAOM,S,KACd,KAGXN,EAAOE,KAAKzE,KAAI,SAACqF,GAAM,OACtB,gBAAC,WAAc,CAAC/C,IAAK,SAAS+C,EAAE1C,IAC9B,gBAACkB,GAAS,WAAKwB,I,KACP,QAGZ,gBAACxB,GAAS,WAAKU,EAAOQ,QAK5B,SAASI,EAAWrD,GAClB,OACE,gBAAC,KAAK,SACJU,UAAW,IACXzB,MAAM,YACNuE,GAAI,EACJC,MAAO,CAAEC,cAAe,WACpB1D,IAKV,SAAS2D,EAAa,G,IAAExB,EAAM,SAAEC,EAAU,aAAE,IAAAwB,aAAAA,OAAY,IAAG,GAAK,EAC9D,OACE,gBAAClC,EAAO,CAACzB,QAAQ,OAAO4D,WAAW,SAASzD,GAAG,gBAC7C,gBAAC8B,GAAY,WAAK,CAAEC,OAAM,EAAEC,WAAU,KACtC,gBAAC,IAAK,CAAC0B,SAAU,MACdF,GACDG,EAAA,mBAA2B5B,GAAQ,SAAC6B,GAAQ,OAC1C,gBAAC,IAAK,CACJH,WAAW,SACX5D,QAAQ,OACRrB,OAAQ,GACRsB,eAAe,SACf+D,MAAO,GACPC,GAAI,CAAE7D,IAAK,IAAM8D,GAAI,IAErB,gBAAC,IAAY,CAACC,KAAMJ,EAAKV,MAAM,WAAWe,UAAQ,GAChD,gBAAC,IAAM,6BAQrB,SAASC,EAAc,G,IAAEvB,EAAM,SAAEZ,EAAM,SAAEoC,EAAI,OAAEnC,EAAU,aAC/CC,EAASC,EAAA,KAAiB,KAClC,OACE,gBAACZ,EAAO,CAACtB,GAAI,GACX,gBAACiD,EAAU,CAACC,MAAM,UAAU5C,UAAW,IAAW8D,QAAQ,oBACxD,wBACEC,KAAK,eACLC,EAAE,qLAGN,8BACKtC,GACD,gCACE,gBAACL,EAAS,CAAClB,GAAIwB,EAAKsC,kBAAkB5B,IAAUA,G,KACxC,KAGZ,gBAAChB,EAAS,CAAClB,GAAIwB,EAAKuC,kBAAkB7B,EAAQZ,EAAQoC,IACnDpC,EACD,gBAAC,IAAK,CAACzB,UAAU,OAAOzB,MAAM,aAAW,KAGxC,IAAO,GAAIsF,KAGhB,gBAAC,IAAK,CAACT,SAAU,KAKvB,IAAMe,EAAiB,SAAC,G,IAAE7B,EAAQ,WAAO,uBAAC,IAAK,CAAC7C,GAAI,GAAI6C,IAElD8B,EAAiB,SAAC,GAAE,IAAA9B,EAAQ,WAAKhD,GAAK,UAApB,cAA2B,OACjD,gBAAC,KAAY,SAACO,QAAQ,MAASP,GAC5BgD,IAIC+B,EAAO,SAAC,G,IAAK/E,GAAK,UAAV,IAAiB,OAC7B,gBAAC,KAAK,SACJf,MAAM,eACN+F,WAAW,oBACXtE,UAAU,QACNV,KAIFiF,EAAS,IAAS,OAAT,CAAiB,CAAEC,WAAY,WAExCC,EAAuB,KAAa,SAAC7G,GAAM,OAC/C8G,iBAAkB,CAChBnG,MAAOX,EAAEG,QAAQ4G,KAAKC,UACtBN,WAAY1G,EAAEqD,WAAW4D,iBAE3BrC,QAAS,CACPsC,WAAYlH,EAAEqD,WAAW8D,UAAUD,WACnCR,WAAY1G,EAAEqD,WAAW+D,kBAE3BC,UAAU,SACRC,aAAc,aACdpG,OAAQ,WACL,SAIP,SAASqG,GAAY,G,IAAE9C,EAAM,SAAEF,EAAI,OAAEK,EAAO,UAAE4C,EAAQ,WAC9CjG,EAAUsF,IACR9C,EAASC,EAAA,KAAiB,KAC5B,EAAoC,YAAe,GAAlDyD,EAAa,KAAEC,EAAgB,KAChCC,EAAiB,eAAkB,WACvCD,GAAkBD,KACjB,CAACC,EAAkBD,IAEhBzH,EAAI,MACJ+B,EAAK,IAAgB/B,EAAE2C,YAAYC,KAAK,OACxCgF,EAAO,SAACC,EAAKC,GACjB,IAAMC,EAAI,GAAGF,EACb,OAAO9F,EAAKgG,EAAEC,UAAU,EAAGF,GAAOC,GAGpC,OACE,gBAAC,IAAK,CAAClG,GAAI,GACT,gBAAC,IAAY,CAACI,QAAQ,YAAYE,UAAWZ,EAAQuF,kBACnD,gBAACH,EAAM,K,UACG,IACR,gBAACjD,EAAA,EAAU,CACTnB,GAAIwB,EAAKS,WAAWC,EAAQF,EAAMK,EAAQqD,IAC1C9F,UAAWZ,EAAQqD,SAElBgD,EAAKhD,EAAQqD,GAAI,MAEZ,IACV,gBAACtB,EAAM,K,QACA,gBAACF,EAAI,KAAE7B,EAAQsD,QAAQC,kBAC3B,MACD,gBAAC1B,EAAI,MAAE,QAAc7B,EAAQwD,SAGhCZ,EAASa,OAAS,GACjB,gBAAC,IAAY,KAEX,wBAAMlG,UAAWZ,EAAQ8F,SAAU7E,QAASmF,GACzCF,EAAgB,QAAU,Q,kBAAwBD,EAASa,O,MAIjEb,EAASa,OAAS,GAAKZ,GACtB,gBAAClB,EAAc,KACb,gBAACC,EAAc,CAAC8B,cAAY,oCAC3Bd,EAAS5H,KAAI,SAAC2I,GAAM,OACnB,gBAAC,IAAY,CACXrG,IAAQqG,EAAEL,QAAQM,UAAS,IAAID,EAAEN,GACjChG,QAAQ,QACRE,UAAWZ,EAAQuF,kBAEnB,gBAACpD,EAAA,EAAU,CACTnB,GAAIwB,EAAKS,WAAWC,EAAQF,EAAMgE,EAAEN,IACpC9F,UAAWZ,EAAQqD,SAElBgD,EAAKW,EAAEN,GAAI,IAEb,SACD,gBAACxB,EAAI,KAAE8B,EAAEL,QAAQC,kBAChB,MACAI,EAAEE,aACD,gBAAChC,EAAI,sBAEL,gBAACA,EAAI,MAAE,QAAc8B,EAAEH,aAUvC,IAAMM,GAAsB,KAAa,SAAC1I,GAAM,OAC9C2I,KAAM,CACJC,OAAQ,aAAa5I,EAAEG,QAAQ0I,KAAK,KACpChG,aAAc7C,EAAE8I,MAAMjG,aACtBkG,UAAW/I,EAAES,QAAQ,IACrByC,UAAWlD,EAAES,QAAQ,GACrBuI,UAAWhJ,EAAES,QAAQ,IACrBuC,QAAShD,EAAES,QAAQ,GACnBiC,SAAU,WAEV,QAAS,CACPuG,WAAY,OACZC,YAAa,QAIf,mBAAoB,CAGlBC,SAAU,SAGV,wCAAyC,CACvCxH,QAAS,UAIfyH,SAAU,CACRL,UAAW,QAEbM,KAAM,CACJ9D,WAAY,WACZrF,WAAY,kKAMZoJ,OAAQ,EACR3H,QAAS,OACTrB,OAAQ,OACRsB,eAAgB,SAChB2H,KAAM,EACNvG,QAAShD,EAAES,QAAQ,GACnBiC,SAAU,WACViD,MAAO,OACP6D,OAAQ,OAIZ,SAASC,GAAW,G,MAAE/E,EAAQ,WAAEM,EAAK,QAC7BzD,EAAUmH,KACV,EAA0B,YAAe,GAAxCU,EAAQ,KAAEM,EAAW,KACtBC,EAAS,eAAkB,WAC/BD,GAAY,KACX,CAACA,IACJ,OACE,gBAACnD,EAAc,KACZvB,GAAS,gBAACwB,EAAc,KAAExB,GAE3B,uBAAK7C,UAAW,IAAGZ,EAAQoH,MAAI,KAAI,EAACpH,EAAQ6H,UAAWA,EAAQ,KAC5D1E,GAEC0E,GACA,uBAAKjH,UAAWZ,EAAQ8H,MACtB,gBAAC,IAAQ,CAACpH,QAAQ,WAAWO,QAASmH,GAAM,aAUxD,IAAMC,GAAiB,SAAClF,GAAa,uBAAC+E,IAAU,WAAK,CAAE/E,SAAQ,MAE/D,SAASmF,GAAe,G,IACJC,EADMjG,EAAM,SAAEkG,EAAmB,sBAAEC,EAAoB,uBAgCzE,OA/BkBF,EA+BFG,EAAA,GAAgB,CAAEL,eAAc,KA9B9CG,EAAoBG,KAAK,CACvBC,EAAGL,EACHM,IAAK,WAAM,OAAAN,EAASO,EAAA,MAAgBJ,EAAA,gBAAkC,CAAEpG,OAAM,OAC9EyG,GAAI,WACF,OAAAN,EAAqBE,KAAK,CACxBC,EAAGL,EACHM,IAAK,SAACG,GACJ,OAAAT,EACEO,EAAA,MACEJ,EAAA,cAAgC,CAAEpG,OAAM,EAAE2G,cAAeD,OAG/DD,GAAIG,EAAA,QAA8B,CAChCC,OAAQ,SAACC,GACP,OAAIA,EAAEC,QACGd,EAASO,EAAA,MAAgBJ,EAAA,WAA6B,CAAEpG,OAAM,MAEnE8G,EAAEE,SACGf,EACLO,EAAA,MAAgBJ,EAAA,YAA8B,CAAEpG,OAAM,MAGnDoG,EAAA,GAAapG,EAAQiG,IAE9BgB,aAAc,WACZ,OAAAhB,EAASO,EAAA,MAAgBJ,EAAA,kBAAoC,CAAEpG,OAAM,cAQnF,SAASkH,GAAK,G,IAAEC,EAAI,OAClB,OAAKA,GAAQ,IAAUA,GAAc,KAGnC,gBAACvB,GAAU,CAACzE,MAAM,YAChB,gBAACiG,EAAA,EAAW,CAACC,gBAAiB,EAAGC,MAAOH,KAK9C,IAAMI,GAAwB,KAAa,SAACpL,GAAM,OAChDqL,UAAU,oBACLrL,EAAEqD,WAAWiI,WAAS,CACzB3K,MAAOX,EAAEG,QAAQ4G,KAAKC,UACtBN,WAAY1G,EAAEqD,WAAW4D,gBACzB/D,UAAWlD,EAAES,QAAQ,KAEvB8K,KAAM,CACJrE,WAAYlH,EAAEqD,WAAW8D,UAAUD,WACnCR,WAAY1G,EAAEqD,WAAW+D,kBAE3BoE,KAAK,oBACAxL,EAAEqD,WAAWoI,OAAK,CACrBC,gBAAiB,WACjBC,gBAAiB,EACjBhK,QAAS,cACTuB,UAAWlD,EAAES,QAAQ,GACrB0I,SAAU,SACVyC,aAAc,aACdC,aAAc,iBAIlB,SAASC,GAAa,G,IAAErH,EAAM,SAAEZ,EAAM,SAAEoC,EAAI,OAAE8F,EAAO,UAAEC,EAAY,eAC3DzK,EAAU6J,KACRrH,EAASC,EAAA,KAAiB,KAClC,OACE,gBAAC,IAAK,KACJ,qBAAG7B,UAAWZ,EAAQ8J,UACpB,gBAAC1E,EAAM,K,WACI,IACT,gBAACjD,EAAA,EAAU,CACTnB,GAAIwB,EAAKuC,kBAAkB7B,EAAQZ,EAAQoC,GAC3C9D,UAAWZ,EAAQgK,KACnBvG,MAAOiB,GAEN,IAAO,GAAIA,KAEN,IACV,gBAACU,EAAM,K,QACA,gBAACF,EAAI,KAAEuF,EAAa7D,oBAG7B,qBAAGhG,UAAWZ,EAAQiK,KAAMO,GAAW,yCAK7C,SAASE,GAAU,GAAE,IAAAC,EAAG,MAAKxK,GAAK,UAAf,SACXyK,EAAYD,EAAI3H,KAAKL,SAAS,KAAOkI,GAASC,GACpD,OAAO,gBAACF,GAAS,qBAAOD,IAAG,GAAKxK,KAGlC,SAAS2K,GAAQ,G,IAAEvI,EAAU,aAAE,IAAAoI,IAAO3H,EAAI,OAAEiD,EAAQ,WAAE/C,EAAM,SACpD6H,EAAMC,EAAA,KACNC,EAAK/G,EAAIgH,GAAGC,MAEZnE,EAAIf,EAAS,GACb3D,EAAS,CAAEY,OAAM,EAAEvC,IAAKqC,EAAMK,QAAS2D,EAAEN,IAEzC8B,GAAsB,QAAmBtF,GACzCuF,EAAuB2C,EAAA,GAASlC,EAAA,IAA6B,SAAE+B,GAAE,GAAK3I,IAEtEyB,GACHgH,EAAIM,YACL7C,EAAoBG,KAAK,CACvBC,EAAG,WAAM,UACTG,GAAI,WACF,OAAAN,EAAqBE,KAAK,CACxBC,EAAG,WAAM,UACTG,GAAIG,EAAA,QAA8B,CAChCN,EAAG,WAAM,UACTO,OAAQ,SAAC,G,IAAEE,EAAO,UAAEC,EAAQ,WAAO,OAACD,IAAYC,UAK1D,OACE,gBAACpI,EAAO,KACN,gBAAC4C,GAAY,WAAK,CAAExB,OAAM,EAAEC,WAAU,EAAEwB,aAAY,KACpD,gBAACiC,GAAW,CAAC9C,OAAQA,EAAQF,KAAMA,EAAMK,QAAS2D,EAAGf,SAAUA,IAC/D,gBAACuD,GAAI,CAACC,KAAMzC,EAAEyC,OACd,gBAACnB,IAAc,WAAK,CAAEhG,OAAM,EAAEkG,oBAAmB,EAAEC,qBAAoB,MAK7E,SAASoC,GAAO,G,IACdtI,EAAU,aACV,IAAAoI,IACE3H,EAAI,OACOgE,EAAC,cAIR1E,EAAS,CAAEY,OAHT,SAGiBvC,IAAKqC,GAC9B,OACE,gBAAC9B,EAAO,KACN,gBAAC4C,GAAY,WAAK,CAAExB,OAAM,EAAEC,WAAU,KACtC,gBAACiH,GAAI,CAACC,KAAMzC,EAAEyC,QAKpB,SAAS6B,GAAW,G,IAClB/I,EAAU,aACV,IAAAoI,IAAOzH,EAAM,SAAEZ,EAAM,SAAEoC,EAAI,OAAE+F,EAAY,eAAEhB,EAAI,OAAE8B,EAAI,OAAEf,EAAO,UAE9D,OACE,gBAACtJ,EAAO,KACN,gBAACuD,GAAa,WAAK,CAAEnC,OAAM,EAAEY,OAAM,EAAEwB,KAAI,EAAEnC,WAAU,KACrD,gBAACgI,IAAY,WAAK,CAAErH,OAAM,EAAEZ,OAAM,EAAEoC,KAAI,EAAE8F,QAAO,EAAEC,aAAY,KAC9Dc,GAAQA,EAAKzE,OAAS,GACrB,gBAAC,IAAK,CAACxG,GAAI,GACRiL,EAAKlN,KAAI,SAACI,GAAM,OACf,gBAAC,WAAc,CAACkC,IAAKlC,GACnB,gBAAC,IAAM,CAACiC,QAAQ,WAAWmG,KAAK,QAAQ9D,MAAOtE,IAAM,SAK7D,gBAAC+K,GAAI,CAACC,KAAMA,KAKX,SAAS+B,GAAIrL,GAClB,IAAMyK,EAA+B,YAAnBzK,EAAMwK,IAAIc,KAAqBH,GAAaZ,GAC9D,OAAO,gBAACE,GAAS,WAAKzK,IAGjB,SAASuL,GAAK,G,IACnBC,EAAI,OACJ7N,EAAI,OACJ8N,EAAS,YACT9L,EAAW,cACX,IAAA+L,QAAAA,OAAO,IAAG,EApeK,GAoeG,EAClBtJ,EAAU,aAEJuJ,EAAahO,GAAQ,EACrBD,EAAQkO,KAAKC,KAAKL,EAAK7E,OAAS+E,GAEhCI,EAAY,WAChB,WACE,OAAU,IAAVpO,EAAc8N,EAAOA,EAAKO,OAAOJ,EAAa,GAAKD,EAASC,EAAaD,KAC3E,CAACF,EAAMG,EAAYD,EAAShO,IAS9B,OANA,EAAAsO,EAAA,GAAYL,GAAY,SAACM,GACnBA,GAAQN,IAAeM,GAAQR,EAAUzN,SAC3CyN,EAAUzN,QAAQkO,oBAKpB,gCACGJ,EAAU5N,KAAI,SAACsM,GAAQ,OACtB,gBAACa,GAAG,CAAC7K,IAAKgK,EAAIhK,IAAKgK,IAAKA,EAAKpI,WAAYA,OAE1C1E,EAAQ,GAAK,gBAAC,KAAU,WAAK,CAAEA,MAAK,EAAEC,KAAMgO,EAAYhM,YAAW,MAK1E,IAAMwM,GAAe,KAAa,SAAC7N,G,MAAM,OACvC2I,MAAI,GACFxF,WAAYnD,EAAES,QAAQ,IACtB,EAACT,EAAE2C,YAAYC,KAAK,OAAQ,CAC1BE,UAAW,aAAa9C,EAAEG,QAAQ4C,QAClCvC,YAAaR,EAAES,QAAQ,GACvBC,aAAcV,EAAES,QAAQ,I,OAKvB,SAASqN,GAAI,GAAE,IAAA3L,EAAS,YAAKT,GAAK,UAArB,eACZH,EAAUsM,KAChB,OAAO,gBAAC,KAAK,SAAC1L,UAAW,IAAGA,EAAWZ,EAAQoH,OAAWjH,IAGrD,SAASqM,GAAS,G,IAAErJ,EAAQ,WACjC,OACE,gBAACoJ,GAAG,KACF,gBAACE,EAAA,EAAK,CAACC,cAAY,IAChB,SAACC,GAAU,OACV,gBAAC,IAAM,CAACC,GAAID,GACV,gBAAC,IAAK,CAACvM,QAAQ,OAAO4D,WAAW,UAC/B,gBAAC,IAAK,CAAC6I,GAAI,GACT,gBAAC,IAAkB,CAAChG,KAAM,MAE5B,gBAAC,IAAY,CAACnG,QAAQ,SAASyC,SAStC,IAAM2J,GAAY,SAACC,GAAa,gBAAC/D,GACtC,OACE,gBAACuD,GAAG,KACF,gBAAC,IAAY,CAAC7L,QAAQ,KAAKqG,cAAY,GACtB,sBAAdiC,EAAEgE,QACD,uDACgB,YAAdhE,EAAEgE,QACJ,mDAEA,iDAGW,sBAAdhE,EAAEgE,QACD,gBAAC,IAAY,CAACjG,cAAY,G,yEACoD,IAC5E,gBAAC5E,EAAA,EAAU,CAACoC,KA/iBG0I,oHA+iBkBC,OAAO,UAAQ,0B,MAI7CH,GACD,yGAGY,YAAd/D,EAAEgE,QACJ,gBAAC,IAAY,CAACjG,cAAY,G,qCACW,IACnC,gBAAC5E,EAAA,EAAU,CAACoC,KAzjBM0I,2GAyjBkBC,OAAO,UAAQ,sBAErC,I,4CAIhB,gBAAC,IAAY,CAACnG,cAAY,G,+GAGrBgG,GAAY,6F,OAGhB/D,EAAEmE,QAAU,gBAAC,IAAY,K,WAAUnE,EAAEmE,UACrCnE,EAAEoE,MAAQ,gBAAC,IAAY,K,SAAQpE,EAAEoE,QACjCpE,EAAEqE,SACH,gCACE,gBAAC,IAAY,uBACb,gBAAC,IAAY,CAACzJ,MAAO,CAAEyB,WAAY,QAAU2D,EAAEqE,YAGhDN,GACD,gBAAC,IAAK,CAACO,GAAI,GACT,gBAAC,IAAQ,CAACzM,UAAW,EAAAE,KAAMC,GAAI+L,EAAU3N,MAAM,UAAUsB,QAAQ,aAAW,8BAQ/E,SAAS6M,GAAa,G,IAAEpK,EAAQ,WACrC,OACE,gBAACoJ,GAAG,KACF,gBAAC,IAAY,CAAC7L,QAAQ,SAAO,kDAG5ByC,K,qCCxgBWqK,E,+KAzGlB,2B,+CAA4C,OAAX,aAAW,EAA5C,CAAiC,KAE3BC,EAAY,SAAC5I,GAAM,OAAAA,GAAK,IAAI6I,KAAK7I,IAEjC8I,EAAkB,YA0ClBC,EAAiB,SAAC,G,MAAE1K,EAAM,SAAE2K,EAAK,QAAEC,EAAG,MACpCnN,EAAM,UAAUuC,EAAM,IAAI4K,EAAInN,IACpC,OAAO,EAAP,IACGA,GAAM,CACLA,IAAG,EACH8K,KAAM,SACNoC,MAAK,EACL3K,OAAM,EACNF,KAAM8K,EAAInN,IACVsF,SAAU,CACR,CACES,GAAIoH,EAAIC,WACRF,MAAK,EACLlH,QAAS8G,EAAUK,EAAInH,SACvB8D,aAAcgD,EAAUK,EAAIE,eAC5BnH,KAAMiH,EAAIjH,KACV4C,KAAMqE,EAAIG,UACV/G,aAAc4G,EAAII,iB,GAOtBC,EAAY,SAAC3H,GACjB,IACE,OAAO4H,KAAKC,MAAM7H,GAClB,MAAOwC,GACP,OAAOxC,IAIL8H,EAAiB,SAAC,G,MAAEpL,EAAM,SAAE2K,EAAK,QAAEC,EAAG,MAC1C,GAAIA,EAAII,gBAAkBJ,EAAIpJ,KAAM,MAAO,GAC3C,IAAM/D,EAAM,WAAWuC,EAAM,IAAI4K,EAAIxL,OAAM,IAAIwL,EAAIpJ,KACnD,OAAO,EAAP,IACG/D,GAAM,CACLA,IAAG,EACH8K,KAAM,UACNvI,OAAM,EACN2K,MAAK,EACLvL,OAAQwL,EAAIxL,OACZoC,KAAMoJ,EAAIpJ,KACV+F,aAAcgD,EAAUK,EAAIE,eAC5BvE,KAAM0E,EAAUL,EAAIS,UAEpB/D,QAASsD,EAAItD,S,GAKbgE,EAAc,SAAC,G,IAAUX,EAAK,SAAWC,EAAG,UAC1C,EA7D0B,SAACW,GACjC,IAAMlQ,EAAIkQ,EAAIC,YAAY,aACpBC,GAAuB,IAAPpQ,EAAWkQ,EAAMA,EAAIvC,MAAM,EAAG3N,GAC9CqQ,EAAYD,EAAcD,YAAYf,GAC5C,OAAsB,IAAfiB,EACH,CAAEnD,KAAM,SAAUvI,OAAQyL,GAC1B,CAAElD,KAAM,UAAWvI,OAAQyL,EAAczC,MAAM,EAAG0C,IAuD7BC,CADoC,UACrDpD,EAAI,OAAEvI,EAAM,SAEpB,OADyB,WAATuI,EAAoBmC,EAAiBU,GACtC,CAAEpL,OAAM,EAAE2K,MAAK,EAAEC,IAAG,KAG/BgB,EAAQ,SAACC,EAAIC,GAAM,OAAAA,GAInBC,EAAY,KAFAzB,EAGP,CACPK,MAAO,IACP5H,SAAU,IACR,IACA,KAAS,SAACe,GAAM,OAACA,EAAE6G,WAPG,SAAClN,EAAKuO,EAAGF,GAAM,OAACxB,EAAM7M,IAAQmO,GAAOI,EAAGF,MAY9DG,EAAe,IACnB,KAAS,SAACC,EAAKzE,GAAQ,OAAAsE,EAAUG,EAAKZ,EAAY7D,MAAO,IACzD,IACA,KAAS,SAACvB,GAAM,OAACA,EAAEyE,UAKN,SAASwB,IAAxB,WACQC,EAAM,OACNC,EAAgB,OAChBC,EAAa,WACjB,WAAM,OAAAD,EAAclR,KAAI,SAACoR,GAAM,OAAAA,EAAEC,UACjC,CAACH,IAGH,OAAO,eACL,SAAO,G,IACLI,EAAK,QACL,IAAAC,QAAAA,OAAO,IAAG,KAAE,EACZ,IAAAC,KAAAA,OAAI,IAAG,QAAK,EACZC,EAAK,Q,qHAECC,EAAQ,KACZH,EAAQ9I,OAAS8I,EAAUJ,EAC3B,KAAQ,SAACC,GACP,IAAMO,EAAO,GAOb,MANa,YAATH,GAA+B,QAATA,GACxBG,EAAKC,KAAKR,GAEC,aAATI,GAAgC,QAATA,GACzBG,EAAKC,KAAK,GAAGR,EAAI9B,GAEZqC,KAET,IAAO,M,iBAIQ,O,sBADTE,GAAK,OAAS,CAAEH,MAAK,EAAEI,OAAQ,SAAUR,MAAK,EAAEG,MAAK,IAC5C,GAAMR,EAAI,UAAUY,I,OAEnC,OAFME,EAAS,SAER,CAAP,EAAO,CAAEzE,KADIwD,EAAaiB,EAAOzE,KAAKA,MACvBzN,MAAOkS,EAAOzE,KAAKzN,Q,OAElC,I,sBAAiB,KAAwB,CAEvC,GADMmS,EAAQ,EAAE7K,KAAK6K,MAAM,4CAChB,CAIT,GAHMjD,EAAOiD,EAAM,GAxCb7J,EAyCmB6J,EAAM,GAAzBhD,EAzCM7G,EAAE8J,QAAQ,OAAQ,MA2CjB,qCAATlD,EACF,MAAM,IAAImD,EAAY,oBAAqB,CAAElD,QAAO,IAGtD,MAAM,IAAIkD,EAAY,eAAgB,CACpCnD,KAAI,EACJC,QAAO,EACPF,OAAQqD,SAASH,EAAM,GAAI,UAAOI,IAGtC,GAAI,EAAEjL,MAAQ,qBAAqBkL,KAAK,EAAElL,MACxC,MAAM,IAAI+K,EAAY,WAO1B,MAHAI,QAAQC,IAAI,iBAEZD,QAAQE,MAAM,GACR,IAAIN,EAAY,aAAc,CAAEtH,cAAe,I,iBA7D5C,IAACzC,UAgEd,CAAC8I,EAAKE","sources":["webpack://quilt-navigator/./app/components/Pagination2/Pagination2.js","webpack://quilt-navigator/./app/components/ResponsiveSection/ResponsiveSection.js","webpack://quilt-navigator/./app/components/SearchResults/SearchResults.js","webpack://quilt-navigator/./app/utils/search.js"],"sourcesContent":["import cx from 'classnames'\nimport * as R from 'ramda'\nimport * as React from 'react'\nimport { Link } from 'react-router-dom'\nimport * as M from '@material-ui/core'\n\nconst Gap = Symbol('gap')\n\nconst MAX_PAGE_BUTTONS = 8 // fits on 320px-wide screen\n\n// 1-based\n// total | current  | output\n// ------|----------|----------------------\n// 8     | *        | [1, 2, 3, 4, 5, 6, 7, 8]\n// 100   | 1...4    | [1, 2, 3, 4, 5, 6, <G>, 100]\n// 100   | 5...95   | [1, <G>, N-1, N, N+1, N+2, <G>, 100]\n// 100   | 96...100 | [1, <G>, 95, 96, 97, 98, 99, 100]\nconst displayRange = (total, current, max = MAX_PAGE_BUTTONS) => {\n  if (total <= max) return R.range(1, total + 1)\n  if (current <= max - 4) {\n    return [...R.range(1, max - 1), Gap, total]\n  }\n  if (current >= total - max + 4) {\n    return [1, Gap, ...R.range(total - max + 3, total + 1)]\n  }\n  return [1, Gap, ...R.range(current - 1, current + 3), Gap, total]\n}\n\nexport const renderPageRange = ({ pages, page, max, renderPage, renderGap }) =>\n  displayRange(pages, page, max).map((p, i) => (p === Gap ? renderGap(i) : renderPage(p)))\n\nconst useStyles = M.makeStyles((t) => ({\n  button: {\n    background: t.palette.common.white,\n    height: 40,\n    lineHeight: 1,\n    paddingLeft: t.spacing(1.5),\n    paddingRight: t.spacing(1.5),\n  },\n  current: {\n    color: t.palette.primary.contrastText,\n    backgroundColor: t.palette.primary.main,\n    '&:hover': {\n      backgroundColor: t.palette.primary.dark,\n    },\n  },\n  gap: {\n    cursor: 'default',\n    pointerEvents: 'none',\n  },\n}))\n\nexport default React.forwardRef(function Pagination2(\n  {\n    page,\n    pages,\n    makePageUrl,\n    onChange,\n    classes: customClasses = {},\n    buttonGroupProps,\n    ...props\n  },\n  ref,\n) {\n  const classes = useStyles()\n\n  const renderGap = (i) => (\n    <M.Button\n      // eslint-disable-next-line react/no-array-index-key\n      key={`gap:${i}`}\n      className={cx(classes.button, classes.gap, customClasses.button, customClasses.gap)}\n      component=\"span\"\n    >\n      &hellip;\n    </M.Button>\n  )\n\n  const renderPage = (p) => {\n    const ps = {}\n    if (makePageUrl) {\n      ps.component = Link\n      ps.to = makePageUrl(p)\n    }\n    if (onChange) {\n      ps.onClick = () => onChange(p)\n    }\n    return (\n      <M.Button\n        key={`page:${p}`}\n        className={cx(\n          classes.button,\n          customClasses.button,\n          page === p && classes.current,\n          page === p && customClasses.current,\n        )}\n        {...ps}\n      >\n        {p}\n      </M.Button>\n    )\n  }\n\n  return (\n    <M.Box\n      display=\"flex\"\n      justifyContent=\"center\"\n      mt={3}\n      mb={{ xs: 5, sm: 0 }}\n      {...props}\n      ref={ref}\n    >\n      <M.ButtonGroup variant=\"contained\" {...buttonGroupProps}>\n        {renderPageRange({ pages, page, renderGap, renderPage })}\n      </M.ButtonGroup>\n    </M.Box>\n  )\n})\n","import * as M from '@material-ui/core'\n\nexport const Section = M.styled(M.Paper)(({ theme: t }) => ({\n  position: 'relative',\n  [t.breakpoints.down('xs')]: {\n    borderRadius: 0,\n    borderTop: `1px solid ${t.palette.divider}`,\n    padding: t.spacing(2),\n  },\n  [t.breakpoints.up('sm')]: {\n    marginTop: t.spacing(2),\n    padding: t.spacing(4),\n    paddingTop: t.spacing(3),\n  },\n}))\n\nexport const Heading = M.styled(M.Box)(({ theme: t }) => ({\n  ...t.typography.h6,\n  lineHeight: 1.4,\n  marginBottom: t.spacing(1),\n  [t.breakpoints.up('sm')]: {\n    marginBottom: t.spacing(2),\n  },\n  [t.breakpoints.up('md')]: {\n    ...t.typography.h5,\n  },\n}))\n","import cx from 'classnames'\nimport * as R from 'ramda'\nimport * as React from 'react'\nimport { Link } from 'react-router-dom'\nimport * as M from '@material-ui/core'\n\nimport { copyWithoutSpaces } from 'components/BreadCrumbs'\nimport JsonDisplay from 'components/JsonDisplay'\nimport Pagination from 'components/Pagination2'\nimport * as Preview from 'components/Preview'\nimport { Section, Heading } from 'components/ResponsiveSection'\nimport * as AWS from 'utils/AWS'\nimport AsyncResult from 'utils/AsyncResult'\nimport { useBucketExistence } from 'utils/BucketCache'\nimport * as Config from 'utils/Config'\nimport * as Data from 'utils/Data'\nimport Delay from 'utils/Delay'\nimport * as NamedRoutes from 'utils/NamedRoutes'\nimport StyledLink, { linkStyle } from 'utils/StyledLink'\nimport { getBreadCrumbs } from 'utils/s3paths'\nimport { readableBytes } from 'utils/string'\nimport usePrevious from 'utils/usePrevious'\n\nimport * as requests from 'containers/Bucket/requests'\n\nconst PER_PAGE = 10\nconst ES_V = '6.8'\nconst ES_REF = `https://www.elastic.co/guide/en/elasticsearch/reference/${ES_V}`\nconst ES_REF_SYNTAX = `${ES_REF}/query-dsl-query-string-query.html#query-string-syntax`\nconst ES_REF_WILDCARDS = `${ES_REF}/query-dsl-query-string-query.html#_wildcards`\n\nconst CrumbLink = M.styled(StyledLink)({ wordBreak: 'break-word' })\n\nfunction ObjectCrumbs({ handle, showBucket = false }) {\n  const { urls } = NamedRoutes.use()\n  const isDir = handle.key.endsWith('/')\n\n  const crumbs = React.useMemo(() => {\n    const all = getBreadCrumbs(handle.key)\n    const dirs = R.init(all).map(({ label, path }) => ({\n      to: urls.bucketFile(handle.bucket, path),\n      children: label,\n    }))\n    const file = {\n      to: urls.bucketFile(handle.bucket, handle.key, handle.version),\n      children: R.last(all).label,\n    }\n    const bucket = showBucket\n      ? {\n          to: urls.bucketRoot(handle.bucket),\n          children: handle.bucket,\n        }\n      : null\n    return { bucket, dirs, file }\n  }, [handle, urls, showBucket])\n\n  return (\n    <span onCopy={copyWithoutSpaces}>\n      <HeaderIcon title={isDir ? 'Directory' : 'File'}>\n        {isDir ? 'folder_open' : 'insert_drive_file'}\n      </HeaderIcon>\n      {crumbs.bucket && (\n        <>\n          <CrumbLink {...crumbs.bucket} />\n          &nbsp;/{' '}\n        </>\n      )}\n      {crumbs.dirs.map((c) => (\n        <React.Fragment key={`crumb:${c.to}`}>\n          <CrumbLink {...c} />\n          &nbsp;/{' '}\n        </React.Fragment>\n      ))}\n      <CrumbLink {...crumbs.file} />\n    </span>\n  )\n}\n\nfunction HeaderIcon(props) {\n  return (\n    <M.Box\n      component={M.Icon}\n      color=\"text.hint\"\n      mr={1}\n      style={{ verticalAlign: 'middle' }}\n      {...props}\n    />\n  )\n}\n\nfunction ObjectHeader({ handle, showBucket, downloadable = false }) {\n  return (\n    <Heading display=\"flex\" alignItems=\"center\" mb=\"0 !important\">\n      <ObjectCrumbs {...{ handle, showBucket }} />\n      <M.Box flexGrow={1} />\n      {!!downloadable &&\n        AWS.Signer.withDownloadUrl(handle, (url) => (\n          <M.Box\n            alignItems=\"center\"\n            display=\"flex\"\n            height={32}\n            justifyContent=\"center\"\n            width={24}\n            my={{ xs: -0.25, md: 0 }}\n          >\n            <M.IconButton href={url} title=\"Download\" download>\n              <M.Icon>arrow_downward</M.Icon>\n            </M.IconButton>\n          </M.Box>\n        ))}\n    </Heading>\n  )\n}\n\nfunction PackageHeader({ bucket, handle, hash, showBucket }) {\n  const { urls } = NamedRoutes.use()\n  return (\n    <Heading mb={1}>\n      <HeaderIcon title=\"Package\" component={M.SvgIcon} viewBox=\"-133 0 1264 1008\">\n        <path\n          fill=\"currentColor\"\n          d=\"M-2 918V446l1004 4v472c0 52-41 93-92 93H91c-52 0-93-43-93-97zM193 3h278v380H0c0-6 0-12 2-16L102 68c14-40 50-65 91-65zm709 63l100 299v2c2 4 2 8 2 12H534V1h277c41 0 77 25 91 65z\"\n        />\n      </HeaderIcon>\n      <span>\n        {!!showBucket && (\n          <>\n            <CrumbLink to={urls.bucketPackageList(bucket)}>{bucket}</CrumbLink>\n            &nbsp;/{' '}\n          </>\n        )}\n        <CrumbLink to={urls.bucketPackageTree(bucket, handle, hash)}>\n          {handle}\n          <M.Box component=\"span\" color=\"text.hint\">\n            @\n          </M.Box>\n          {R.take(10, hash)}\n        </CrumbLink>\n      </span>\n      <M.Box flexGrow={1} />\n    </Heading>\n  )\n}\n\nconst SmallerSection = ({ children }) => <M.Box mt={2}>{children}</M.Box>\n\nconst SectionHeading = ({ children, ...props }) => (\n  <M.Typography variant=\"h6\" {...props}>\n    {children}\n  </M.Typography>\n)\n\nconst Bold = ({ ...props }) => (\n  <M.Box\n    color=\"text.primary\"\n    fontWeight=\"fontWeightRegular\"\n    component=\"span\"\n    {...props}\n  />\n)\n\nconst Nowrap = M.styled('span')({ whiteSpace: 'nowrap' })\n\nconst useVersionInfoStyles = M.makeStyles((t) => ({\n  versionContainer: {\n    color: t.palette.text.secondary,\n    fontWeight: t.typography.fontWeightLight,\n  },\n  version: {\n    fontFamily: t.typography.monospace.fontFamily,\n    fontWeight: t.typography.fontWeightMedium,\n  },\n  seeOther: {\n    borderBottom: '1px dashed',\n    cursor: 'pointer',\n    ...linkStyle,\n  },\n}))\n\nfunction VersionInfo({ bucket, path, version, versions }) {\n  const classes = useVersionInfoStyles()\n  const { urls } = NamedRoutes.use()\n  const [versionsShown, setVersionsShown] = React.useState(false)\n  const toggleVersions = React.useCallback(() => {\n    setVersionsShown(!versionsShown)\n  }, [setVersionsShown, versionsShown])\n\n  const t = M.useTheme()\n  const xs = M.useMediaQuery(t.breakpoints.down('xs'))\n  const clip = (str, len) => {\n    const s = `${str}`\n    return xs ? s.substring(0, len) : s\n  }\n\n  return (\n    <M.Box mt={1}>\n      <M.Typography variant=\"subtitle1\" className={classes.versionContainer}>\n        <Nowrap>\n          Version{' '}\n          <StyledLink\n            to={urls.bucketFile(bucket, path, version.id)}\n            className={classes.version}\n          >\n            {clip(version.id, 24)}\n          </StyledLink>\n        </Nowrap>{' '}\n        <Nowrap>\n          from <Bold>{version.updated.toLocaleString()}</Bold>\n          {' | '}\n          <Bold>{readableBytes(version.size)}</Bold>\n        </Nowrap>\n      </M.Typography>\n      {versions.length > 1 && (\n        <M.Typography>\n          {/* eslint-disable-next-line jsx-a11y/no-static-element-interactions, jsx-a11y/click-events-have-key-events */}\n          <span className={classes.seeOther} onClick={toggleVersions}>\n            {versionsShown ? 'hide ' : 'show '} all versions ({versions.length})\n          </span>\n        </M.Typography>\n      )}\n      {versions.length > 1 && versionsShown && (\n        <SmallerSection>\n          <SectionHeading gutterBottom>Versions ordered by relevance</SectionHeading>\n          {versions.map((v) => (\n            <M.Typography\n              key={`${v.updated.getTime()}:${v.id}`}\n              variant=\"body2\"\n              className={classes.versionContainer}\n            >\n              <StyledLink\n                to={urls.bucketFile(bucket, path, v.id)}\n                className={classes.version}\n              >\n                {clip(v.id, 6)}\n              </StyledLink>\n              {' from '}\n              <Bold>{v.updated.toLocaleString()}</Bold>\n              {' | '}\n              {v.deleteMarker ? (\n                <Bold>Delete Marker</Bold>\n              ) : (\n                <Bold>{readableBytes(v.size)}</Bold>\n              )}\n            </M.Typography>\n          ))}\n        </SmallerSection>\n      )}\n    </M.Box>\n  )\n}\n\nconst usePreviewBoxStyles = M.makeStyles((t) => ({\n  root: {\n    border: `1px solid ${t.palette.grey[300]}`,\n    borderRadius: t.shape.borderRadius,\n    maxHeight: t.spacing(30),\n    marginTop: t.spacing(1),\n    minHeight: t.spacing(15),\n    padding: t.spacing(2),\n    position: 'relative',\n\n    '& img': {\n      marginLeft: 'auto',\n      marginRight: 'auto',\n    },\n\n    // workarounds to speed-up notebook preview rendering:\n    '&:not($expanded)': {\n      // hide overflow only when not expanded, using this while expanded\n      // slows down the page in chrome\n      overflow: 'hidden',\n\n      // only show 2 first cells unless expanded\n      '& .ipynb-preview .cell:nth-child(n+3)': {\n        display: 'none',\n      },\n    },\n  },\n  expanded: {\n    maxHeight: 'none',\n  },\n  fade: {\n    alignItems: 'flex-end',\n    background: `linear-gradient(to top,\n      rgba(255, 255, 255, 1),\n      rgba(255, 255, 255, 0.9),\n      rgba(255, 255, 255, 0.1),\n      rgba(255, 255, 255, 0.1)\n    )`,\n    bottom: 0,\n    display: 'flex',\n    height: '100%',\n    justifyContent: 'center',\n    left: 0,\n    padding: t.spacing(1),\n    position: 'absolute',\n    width: '100%',\n    zIndex: 1,\n  },\n}))\n\nfunction PreviewBox({ children, title }) {\n  const classes = usePreviewBoxStyles()\n  const [expanded, setExpanded] = React.useState(false)\n  const expand = React.useCallback(() => {\n    setExpanded(true)\n  }, [setExpanded])\n  return (\n    <SmallerSection>\n      {title && <SectionHeading>{title}</SectionHeading>}\n\n      <div className={cx(classes.root, { [classes.expanded]: expanded })}>\n        {children}\n\n        {!expanded && (\n          <div className={classes.fade}>\n            <M.Button variant=\"outlined\" onClick={expand}>\n              Expand\n            </M.Button>\n          </div>\n        )}\n      </div>\n    </SmallerSection>\n  )\n}\n\nconst renderContents = (children) => <PreviewBox {...{ children }} />\n\nfunction PreviewDisplay({ handle, bucketExistenceData, versionExistenceData }) {\n  const withData = (callback) =>\n    bucketExistenceData.case({\n      _: callback,\n      Err: () => callback(AsyncResult.Err(Preview.PreviewError.DoesNotExist({ handle }))),\n      Ok: () =>\n        versionExistenceData.case({\n          _: callback,\n          Err: (e) =>\n            callback(\n              AsyncResult.Err(\n                Preview.PreviewError.Unexpected({ handle, originalError: e }),\n              ),\n            ),\n          Ok: requests.ObjectExistence.case({\n            Exists: (h) => {\n              if (h.deleted) {\n                return callback(AsyncResult.Err(Preview.PreviewError.Deleted({ handle })))\n              }\n              if (h.archived) {\n                return callback(\n                  AsyncResult.Err(Preview.PreviewError.Archived({ handle })),\n                )\n              }\n              return Preview.load(handle, callback)\n            },\n            DoesNotExist: () =>\n              callback(AsyncResult.Err(Preview.PreviewError.InvalidVersion({ handle }))),\n          }),\n        }),\n    })\n\n  return withData(Preview.display({ renderContents }))\n}\n\nfunction Meta({ meta }) {\n  if (!meta || R.isEmpty(meta)) return null\n\n  return (\n    <PreviewBox title=\"Metadata\">\n      <JsonDisplay defaultExpanded={1} value={meta} />\n    </PreviewBox>\n  )\n}\n\nconst useRevisionInfoStyles = M.makeStyles((t) => ({\n  revision: {\n    ...t.typography.subtitle1,\n    color: t.palette.text.secondary,\n    fontWeight: t.typography.fontWeightLight,\n    marginTop: t.spacing(2),\n  },\n  mono: {\n    fontFamily: t.typography.monospace.fontFamily,\n    fontWeight: t.typography.fontWeightMedium,\n  },\n  msg: {\n    ...t.typography.body2,\n    WebkitBoxOrient: 'vertical',\n    WebkitLineClamp: 2,\n    display: '-webkit-box',\n    marginTop: t.spacing(1),\n    overflow: 'hidden',\n    overflowWrap: 'break-word',\n    textOverflow: 'ellipsis',\n  },\n}))\n\nfunction RevisionInfo({ bucket, handle, hash, comment, lastModified }) {\n  const classes = useRevisionInfoStyles()\n  const { urls } = NamedRoutes.use()\n  return (\n    <M.Box>\n      <p className={classes.revision}>\n        <Nowrap>\n          Revision{' '}\n          <StyledLink\n            to={urls.bucketPackageTree(bucket, handle, hash)}\n            className={classes.mono}\n            title={hash}\n          >\n            {R.take(10, hash)}\n          </StyledLink>\n        </Nowrap>{' '}\n        <Nowrap>\n          from <Bold>{lastModified.toLocaleString()}</Bold>\n        </Nowrap>\n      </p>\n      <p className={classes.msg}>{comment || <i>No message</i>}</p>\n    </M.Box>\n  )\n}\n\nfunction ObjectHit({ hit, ...props }) {\n  const Component = hit.path.endsWith('/') ? DirHit : FileHit\n  return <Component {...{ hit, ...props }} />\n}\n\nfunction FileHit({ showBucket, hit: { path, versions, bucket } }) {\n  const cfg = Config.use()\n  const s3 = AWS.S3.use()\n\n  const v = versions[0]\n  const handle = { bucket, key: path, version: v.id }\n\n  const bucketExistenceData = useBucketExistence(bucket)\n  const versionExistenceData = Data.use(requests.getObjectExistence, { s3, ...handle })\n\n  const downloadable =\n    !cfg.noDownload &&\n    bucketExistenceData.case({\n      _: () => false,\n      Ok: () =>\n        versionExistenceData.case({\n          _: () => false,\n          Ok: requests.ObjectExistence.case({\n            _: () => false,\n            Exists: ({ deleted, archived }) => !deleted && !archived,\n          }),\n        }),\n    })\n\n  return (\n    <Section>\n      <ObjectHeader {...{ handle, showBucket, downloadable }} />\n      <VersionInfo bucket={bucket} path={path} version={v} versions={versions} />\n      <Meta meta={v.meta} />\n      <PreviewDisplay {...{ handle, bucketExistenceData, versionExistenceData }} />\n    </Section>\n  )\n}\n\nfunction DirHit({\n  showBucket,\n  hit: {\n    path,\n    versions: [v],\n    bucket,\n  },\n}) {\n  const handle = { bucket, key: path }\n  return (\n    <Section>\n      <ObjectHeader {...{ handle, showBucket }} />\n      <Meta meta={v.meta} />\n    </Section>\n  )\n}\n\nfunction PackageHit({\n  showBucket,\n  hit: { bucket, handle, hash, lastModified, meta, tags, comment },\n}) {\n  return (\n    <Section>\n      <PackageHeader {...{ handle, bucket, hash, showBucket }} />\n      <RevisionInfo {...{ bucket, handle, hash, comment, lastModified }} />\n      {tags && tags.length > 0 && (\n        <M.Box mt={2}>\n          {tags.map((t) => (\n            <React.Fragment key={t}>\n              <M.Chip variant=\"outlined\" size=\"small\" label={t} />{' '}\n            </React.Fragment>\n          ))}\n        </M.Box>\n      )}\n      <Meta meta={meta} />\n    </Section>\n  )\n}\n\nexport function Hit(props) {\n  const Component = props.hit.type === 'package' ? PackageHit : ObjectHit\n  return <Component {...props} />\n}\n\nexport function Hits({\n  hits,\n  page,\n  scrollRef,\n  makePageUrl,\n  perPage = PER_PAGE,\n  showBucket,\n}) {\n  const actualPage = page || 1\n  const pages = Math.ceil(hits.length / perPage)\n\n  const paginated = React.useMemo(\n    () =>\n      pages === 1 ? hits : hits.slice((actualPage - 1) * perPage, actualPage * perPage),\n    [hits, actualPage, perPage, pages],\n  )\n\n  usePrevious(actualPage, (prev) => {\n    if (prev && actualPage !== prev && scrollRef.current) {\n      scrollRef.current.scrollIntoView()\n    }\n  })\n\n  return (\n    <>\n      {paginated.map((hit) => (\n        <Hit key={hit.key} hit={hit} showBucket={showBucket} />\n      ))}\n      {pages > 1 && <Pagination {...{ pages, page: actualPage, makePageUrl }} />}\n    </>\n  )\n}\n\nconst useAltStyles = M.makeStyles((t) => ({\n  root: {\n    paddingTop: t.spacing(3),\n    [t.breakpoints.down('xs')]: {\n      borderTop: `1px solid ${t.palette.divider}`,\n      paddingLeft: t.spacing(2),\n      paddingRight: t.spacing(2),\n    },\n  },\n}))\n\nexport function Alt({ className, ...props }) {\n  const classes = useAltStyles()\n  return <M.Box className={cx(className, classes.root)} {...props} />\n}\n\nexport function Progress({ children }) {\n  return (\n    <Alt>\n      <Delay alwaysRender>\n        {(ready) => (\n          <M.Fade in={ready}>\n            <M.Box display=\"flex\" alignItems=\"center\">\n              <M.Box pr={2}>\n                <M.CircularProgress size={24} />\n              </M.Box>\n              <M.Typography variant=\"body1\">{children}</M.Typography>\n            </M.Box>\n          </M.Fade>\n        )}\n      </Delay>\n    </Alt>\n  )\n}\n\nexport const handleErr = (retryUrl) => (e) =>\n  (\n    <Alt>\n      <M.Typography variant=\"h5\" gutterBottom>\n        {e.message === 'SearchSyntaxError' ? ( // eslint-disable-line no-nested-ternary\n          <>Search syntax error</>\n        ) : e.message === 'Timeout' ? (\n          <>Query timed out</>\n        ) : (\n          <>Search error</>\n        )}\n      </M.Typography>\n      {e.message === 'SearchSyntaxError' ? ( // eslint-disable-line no-nested-ternary\n        <M.Typography gutterBottom>\n          Oops, couldn&apos;t parse that search. Try quoting your query or read about{' '}\n          <StyledLink href={ES_REF_SYNTAX} target=\"_blank\">\n            supported query syntax\n          </StyledLink>\n          .\n          {!!retryUrl && (\n            <> You can also click RETRY to try a simplified version of your query.</>\n          )}\n        </M.Typography>\n      ) : e.message === 'Timeout' ? (\n        <M.Typography gutterBottom>\n          That made ElasticSearch sweat. Try{' '}\n          <StyledLink href={ES_REF_WILDCARDS} target=\"_blank\">\n            avoiding wildcards\n          </StyledLink>{' '}\n          or ask Quilt about scaling your cluster.\n        </M.Typography>\n      ) : (\n        <M.Typography gutterBottom>\n          ElasticSearch had trouble with that query. The cluster may be busy indexing new\n          documents. Try again later\n          {!!retryUrl && <> or click RETRY to try a simplified version of your query</>}.\n        </M.Typography>\n      )}\n      {!!e.status && <M.Typography>Status: {e.status}</M.Typography>}\n      {!!e.code && <M.Typography>Code: {e.code}</M.Typography>}\n      {!!e.details && (\n        <>\n          <M.Typography>Error details:</M.Typography>\n          <M.Typography style={{ whiteSpace: 'pre' }}>{e.details}</M.Typography>\n        </>\n      )}\n      {!!retryUrl && (\n        <M.Box pt={2}>\n          <M.Button component={Link} to={retryUrl} color=\"primary\" variant=\"contained\">\n            Retry simplified query\n          </M.Button>\n        </M.Box>\n      )}\n    </Alt>\n  )\n\nexport function NothingFound({ children }) {\n  return (\n    <Alt>\n      <M.Typography variant=\"body1\">\n        We have not found anything matching your query\n      </M.Typography>\n      {children}\n    </Alt>\n  )\n}\n","import * as FP from 'fp-ts'\nimport * as R from 'ramda'\nimport * as React from 'react'\n\nimport * as APIConnector from 'utils/APIConnector'\nimport * as BucketConfig from 'utils/BucketConfig'\nimport { BaseError } from 'utils/error'\nimport mkSearch from 'utils/mkSearch'\n\nexport class SearchError extends BaseError {}\n\nconst parseDate = (d) => d && new Date(d)\n\nconst PACKAGES_SUFFIX = '_packages'\n\n/*\nFile: {\n  key: str,\n  type: 'object',\n  score: num,\n  bucket: str,\n  path: str,\n  versions: [\n    {\n      id: str,\n      score: num,\n      updated: ?Date,\n      lastModified: ?Date,\n      size: num,\n      meta: str,\n    },\n  ],\n}\n\nPackage: {\n  key: str,\n  type: 'package',\n  score: num,\n  bucket: str,\n  handle: str,\n  hash: str,\n  lastModified: ?Date,\n  meta: str, // should it be parsed?\n}\n*/\n\nconst getTypeAndBucketFromIndex = (idx) => {\n  const i = idx.lastIndexOf('-reindex-')\n  const idxNormalized = i === -1 ? idx : idx.slice(0, i)\n  const suffixIdx = idxNormalized.lastIndexOf(PACKAGES_SUFFIX)\n  return suffixIdx === -1\n    ? { type: 'object', bucket: idxNormalized }\n    : { type: 'package', bucket: idxNormalized.slice(0, suffixIdx) }\n}\n\nconst extractObjData = ({ bucket, score, src }) => {\n  const key = `object:${bucket}/${src.key}`\n  return {\n    [key]: {\n      key,\n      type: 'object',\n      score,\n      bucket,\n      path: src.key,\n      versions: [\n        {\n          id: src.version_id,\n          score,\n          updated: parseDate(src.updated),\n          lastModified: parseDate(src.last_modified),\n          size: src.size,\n          meta: src.user_meta,\n          deleteMarker: src.delete_marker,\n        },\n      ],\n    },\n  }\n}\n\nconst parseJSON = (s) => {\n  try {\n    return JSON.parse(s)\n  } catch (e) {\n    return s\n  }\n}\n\nconst extractPkgData = ({ bucket, score, src }) => {\n  if (src.delete_marker || !src.hash) return {}\n  const key = `package:${bucket}/${src.handle}:${src.hash}`\n  return {\n    [key]: {\n      key,\n      type: 'package',\n      bucket,\n      score,\n      handle: src.handle,\n      hash: src.hash,\n      lastModified: parseDate(src.last_modified),\n      meta: parseJSON(src.metadata),\n      // tags: src.tags, // TODO: currently not provided\n      comment: src.comment,\n    },\n  }\n}\n\nconst extractData = ({ _score: score, _source: src, _index: idx }) => {\n  const { type, bucket } = getTypeAndBucketFromIndex(idx)\n  const extract = type === 'object' ? extractObjData : extractPkgData\n  return extract({ bucket, score, src })\n}\n\nconst takeR = (_l, r) => r\n\nconst mkMerger = (cases) => (key, l, r) => (cases[key] || takeR)(l, r)\n\nconst mergeHits = R.mergeDeepWithKey(\n  mkMerger({\n    score: R.max,\n    versions: R.pipe(\n      R.concat,\n      R.sortBy((v) => -v.score),\n    ),\n  }),\n)\n\nconst mergeAllHits = R.pipe(\n  R.reduce((acc, hit) => mergeHits(acc, extractData(hit)), {}),\n  R.values,\n  R.sortBy((h) => -h.score),\n)\n\nconst unescape = (s) => s.replace(/\\\\n/g, '\\n')\n\nexport default function useSearch() {\n  const req = APIConnector.use()\n  const bucketConfigs = BucketConfig.useRelevantBucketConfigs()\n  const allBuckets = React.useMemo(\n    () => bucketConfigs.map((b) => b.name),\n    [bucketConfigs],\n  )\n\n  return React.useCallback(\n    async ({\n      query,\n      buckets = [],\n      mode = 'all', // all | objects | packages\n      retry,\n    }) => {\n      const index = FP.function.pipe(\n        buckets.length ? buckets : allBuckets,\n        R.chain((b) => {\n          const idxs = []\n          if (mode === 'objects' || mode === 'all') {\n            idxs.push(b)\n          }\n          if (mode === 'packages' || mode === 'all') {\n            idxs.push(`${b}${PACKAGES_SUFFIX}`)\n          }\n          return idxs\n        }),\n        R.join(','),\n      )\n      try {\n        const qs = mkSearch({ index, action: 'search', query, retry })\n        const result = await req(`/search${qs}`)\n        const hits = mergeAllHits(result.hits.hits)\n        return { hits, total: result.hits.total }\n      } catch (e) {\n        if (e instanceof APIConnector.HTTPError) {\n          const match = e.text.match(/^RequestError\\((\\d+), '(\\w+)', '(.+)'\\)$/)\n          if (match) {\n            const code = match[2]\n            const details = unescape(match[3])\n\n            if (code === 'search_phase_execution_exception') {\n              throw new SearchError('SearchSyntaxError', { details })\n            }\n\n            throw new SearchError('RequestError', {\n              code,\n              details,\n              status: parseInt(match[1], 10) || undefined,\n            })\n          }\n          if (e.text && /^ConnectionTimeout/.test(e.text)) {\n            throw new SearchError('Timeout')\n          }\n        }\n        // eslint-disable-next-line no-console\n        console.log('Search error:')\n        // eslint-disable-next-line no-console\n        console.error(e)\n        throw new SearchError('Unexpected', { originalError: e })\n      }\n    },\n    [req, allBuckets],\n  )\n}\n"],"names":["Gap","Symbol","renderPageRange","pages","page","max","renderPage","renderGap","total","current","displayRange","map","p","i","useStyles","t","button","background","palette","common","white","height","lineHeight","paddingLeft","spacing","paddingRight","color","primary","contrastText","backgroundColor","main","dark","gap","cursor","pointerEvents","ref","makePageUrl","onChange","classes","customClasses","buttonGroupProps","props","display","justifyContent","mt","mb","xs","sm","variant","key","className","component","ps","Link","to","onClick","Section","position","breakpoints","down","borderRadius","borderTop","divider","padding","up","marginTop","paddingTop","Heading","typography","h6","marginBottom","h5","CrumbLink","StyledLink","wordBreak","ObjectCrumbs","handle","showBucket","urls","NamedRoutes","isDir","endsWith","crumbs","all","dirs","label","path","bucketFile","bucket","children","file","version","bucketRoot","onCopy","HeaderIcon","title","c","mr","style","verticalAlign","ObjectHeader","downloadable","alignItems","flexGrow","AWS","url","width","my","md","href","download","PackageHeader","hash","viewBox","fill","d","bucketPackageList","bucketPackageTree","SmallerSection","SectionHeading","Bold","fontWeight","Nowrap","whiteSpace","useVersionInfoStyles","versionContainer","text","secondary","fontWeightLight","fontFamily","monospace","fontWeightMedium","seeOther","borderBottom","VersionInfo","versions","versionsShown","setVersionsShown","toggleVersions","clip","str","len","s","substring","id","updated","toLocaleString","size","length","gutterBottom","v","getTime","deleteMarker","usePreviewBoxStyles","root","border","grey","shape","maxHeight","minHeight","marginLeft","marginRight","overflow","expanded","fade","bottom","left","zIndex","PreviewBox","setExpanded","expand","renderContents","PreviewDisplay","callback","bucketExistenceData","versionExistenceData","Preview","case","_","Err","AsyncResult","Ok","e","originalError","requests","Exists","h","deleted","archived","DoesNotExist","Meta","meta","JsonDisplay","defaultExpanded","value","useRevisionInfoStyles","revision","subtitle1","mono","msg","body2","WebkitBoxOrient","WebkitLineClamp","overflowWrap","textOverflow","RevisionInfo","comment","lastModified","ObjectHit","hit","Component","DirHit","FileHit","cfg","Config","s3","S3","use","Data","noDownload","PackageHit","tags","Hit","type","Hits","hits","scrollRef","perPage","actualPage","Math","ceil","paginated","slice","usePrevious","prev","scrollIntoView","useAltStyles","Alt","Progress","Delay","alwaysRender","ready","in","pr","handleErr","retryUrl","message","ES_REF","target","status","code","details","pt","NothingFound","cases","parseDate","Date","PACKAGES_SUFFIX","extractObjData","score","src","version_id","last_modified","user_meta","delete_marker","parseJSON","JSON","parse","extractPkgData","metadata","extractData","idx","lastIndexOf","idxNormalized","suffixIdx","getTypeAndBucketFromIndex","takeR","_l","r","mergeHits","l","mergeAllHits","acc","useSearch","req","bucketConfigs","allBuckets","b","name","query","buckets","mode","retry","index","idxs","push","qs","action","result","match","replace","SearchError","parseInt","undefined","test","console","log","error"],"sourceRoot":""}