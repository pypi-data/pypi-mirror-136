
<!DOCTYPE html>

<html lang="zh_CN">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>函数基础 &#8212; d2py 0.1 文档</title>
    
  <link href="../../_static/css/theme.css" rel="stylesheet">
  <link href="../../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/default.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script async="async" kind="hypothesis" src="https://hypothes.is/embed.js"></script>
    <script kind="utterances">

    var commentsRunWhenDOMLoaded = cb => {
    if (document.readyState != 'loading') {
        cb()
    } else if (document.addEventListener) {
        document.addEventListener('DOMContentLoaded', cb)
    } else {
        document.attachEvent('onreadystatechange', function() {
        if (document.readyState == 'complete') cb()
        })
    }
}

var addUtterances = () => {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src = "https://utteranc.es/client.js";
    script.async = "async";

    script.setAttribute("repo", "xinetzone/d2py");
    script.setAttribute("issue-term", "pathname");
    script.setAttribute("theme", "github-light");
    script.setAttribute("label", "💬 comment");
    script.setAttribute("crossorigin", "anonymous");

    sections = document.querySelectorAll("div.section");
    if (sections !== null) {
        section = sections[sections.length-1];
        section.appendChild(script);
    }
}
commentsRunWhenDOMLoaded(addUtterances);
</script>
    <script src="../../_static/translations.js"></script>
    <script src="../../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script>
        const thebe_selector = ".cell"
        const thebe_selector_input = ".cell_input div.highlight"
        const thebe_selector_output = ".cell_output"
    </script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <script src="https://unpkg.com/mermaid/dist/mermaid.min.js"></script>
    <script>mermaid.initialize({startOnLoad:true});</script>
    <link rel="canonical" href="https://xinetzone.github.io/d2py/python-study/drafts/88.html" />
    <link rel="shortcut icon" href="../../_static/page-logo.jfif"/>
    <link rel="index" title="索引" href="../../genindex.html" />
    <link rel="search" title="搜索" href="../../search.html" />
    <link rel="next" title="class" href="class.html" />
    <link rel="prev" title="类型和运算 (Types and Operations)" href="66.html" /> 
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="zh_CN">
    

    <!-- Google Analytics -->
     
<link
  rel="alternate"
  type="application/atom+xml"
  href="../../posts/atom.xml"
  title="Blog"
/>
 
<style type="text/css">
  ul.ablog-archive {
    list-style: none;
    overflow: auto;
    margin-left: 0px;
  }
  ul.ablog-archive li {
    float: left;
    margin-right: 5px;
    font-size: 80%;
  }
  ul.postlist a {
    font-style: italic;
  }
  ul.postlist-style-disc {
    list-style-type: disc;
  }
  ul.postlist-style-none {
    list-style-type: none;
  }
  ul.postlist-style-circle {
    list-style-type: circle;
  }
</style>

  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../../_static/logo.jpg" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">d2py 0.1 文档</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="../index.html">
   Python 学习手册
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../basic/index.html">
     Python 基础教程
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
    <label for="toctree-checkbox-2">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="../basic/intro/index.html">
       Python 简介
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
      <label for="toctree-checkbox-3">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="../basic/intro/understand-python.html">
         解读 Python 世界的修炼体系
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../basic/intro/basic-type.html">
         Python 基本数据类型
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../basic/function.html">
       函数
      </a>
     </li>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="../basic/container/index.html">
       容器
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
      <label for="toctree-checkbox-4">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="../basic/container/set.html">
         集合
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../basic/container/dict.html">
         字典
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../basic/container/sequence.html">
         序列
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../basic/controlflow.html">
       流程控制
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../basic/modules.html">
       模块
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../basic/class.html">
       类
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../basic/template.html">
       模板
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../basic/threading.html">
       多线程
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../basic/logging.html">
       日志记录
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../basic/weakref.html">
       弱引用
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../basic/argparse.html">
       <code class="docutils literal notranslate">
        <span class="pre">
         argparse
        </span>
       </code>
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../basic/input-output.html">
       输入与输出
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../basic/match-statement.html">
       <code class="docutils literal notranslate">
        <span class="pre">
         match
        </span>
       </code>
       语句
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../topics/index.html">
     Python 主题手册
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
    <label for="toctree-checkbox-5">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../topics/Nuitka.html">
       Python 编译器 Nuitka
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../topics/abc.html">
       <code class="docutils literal notranslate">
        <span class="pre">
         abc
        </span>
       </code>
       抽象基类
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../topics/annotations.html">
       注解
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../topics/argparse.html">
       <code class="docutils literal notranslate">
        <span class="pre">
         argparse
        </span>
       </code>
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../topics/custom-numbers.html">
       自定义数字
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../topics/f-string.html">
       格式字符串字面值
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../topics/metaclass.html">
       元类
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../topics/refs.html">
       临时区
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../topics/sys.html">
       系统相关
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../faqs/index.html">
     常见问题
    </a>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../refs/index.html">
     Python 参考手册
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
    <label for="toctree-checkbox-6">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../refs/constants.html">
       内置常量
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../refs/terms.html">
       术语中英对照表
      </a>
     </li>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="../refs/glossary/index.html">
       术语表
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
      <label for="toctree-checkbox-7">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="../refs/glossary/basic.html">
         基本术语
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../refs/glossary/exec.html">
         异常
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../refs/glossary/identifier.html">
         标识符
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../refs/glossary/value.html">
         字面值
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../refs/sources.html">
       Python 学习资源
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../demo.html">
     Jupyter Notebook
    </a>
   </li>
   <li class="toctree-l2 current active has-children">
    <a class="reference internal" href="index.html">
     草稿
    </a>
    <input checked="" class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
    <label for="toctree-checkbox-8">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul class="current">
     <li class="toctree-l3">
      <a class="reference internal" href="101.html">
       一、5 个值得在 2018 年关注的库
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="22.html">
       存储数据
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="33.html">
       类也是对象
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="44.html">
       描述器是什么？
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="55.html">
       字符编码方法
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="66.html">
       类型和运算 (Types and Operations)
      </a>
     </li>
     <li class="toctree-l3 current active">
      <a class="current reference internal" href="#">
       函数基础
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="class.html">
       class
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="draft.html">
       回收站
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="exc.html">
       异常（draft）
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="file.html">
       I/O操作（draft）
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="iter.html">
       迭代&amp;生成（draft）
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="math.html">
       Python 中的数学（draft）
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="oop.html">
       OOP: The Big Picture
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="op.html">
       运算符（draft）
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="re.html">
       re
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="socket.html">
       网络
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="str.html">
       字符编码方法
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="type.html">
       Python 数据类型转换（draft）
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="%E7%88%AC%E8%99%AB.html">
       爬虫
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../FunctionalAnalysis/index.html">
   泛函分析
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/>
  <label for="toctree-checkbox-9">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../FunctionalAnalysis/draft/index.html">
     回收站
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/>
    <label for="toctree-checkbox-10">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../FunctionalAnalysis/draft/abc.html">
       抽象基类
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../FunctionalAnalysis/draft/annotations.html">
       对象注解
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../FunctionalAnalysis/draft/descriptor.html">
       描述器
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../FunctionalAnalysis/draft/typing.html">
       类型提示
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../posts/index.html">
   博客
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../about/index.html">
   关于
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/>
  <label for="toctree-checkbox-11">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../about/feature.html">
     特性
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../about/use.html">
     项目使用
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../CODE_OF_CONDUCT.html">
     行为准则
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../CONTRIBUTING.html">
     贡献
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../SECURITY.html">
     安全策略
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../news/index.html">
   Python 新闻
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  <div>
版权所有 © 2021 <a href="https://xinetzone.github.io/">xinetzone</a></div>
<div>由 <a href="https://ebp.jupyterbook.org/">EBP</a> 提供技术支持</div>

</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/python-study/drafts/88.md.txt"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.md</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/xinetzone/d2py"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/xinetzone/d2py/issues/new?title=Issue%20on%20page%20%2Fpython-study/drafts/88.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        <a class="edit-button" href="https://github.com/xinetzone/d2py/edit/main/docs/python-study/drafts/88.md"><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Edit this page"><i class="fas fa-pencil-alt"></i>suggest edit</button></a>
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> 导航
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   函数基础
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#python">
     Python 中的多态
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id2">
     作用域
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#name-resolution-the-legb-rule">
     Name Resolution: The LEGB Rule
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id3">
     工厂函数
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id4">
     函数的不定长参数
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id5">
     函数设计原则
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id6">
   递归（程序调用自身的编程技巧）
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#n">
     求
     <span class="math notranslate nohighlight">
      \(n!\)
     </span>
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id7">
     求序列的和
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#functional-programming">
   函数式编程（Functional programming）
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id8">
     什么是函数式编程？
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id9">
     为什么使用函数式编程？
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id10">
     如何辨认函数式风格？
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id11">
     函数的合成与柯里化
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id12">
       函数的合成:
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id13">
       柯里化:
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id14">
       函子
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id15">
     函数柯里化
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#uncurrying">
     反柯里化(Uncurrying)
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id16">
       1  函数式编程概述
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#id17">
         1.1  程序的状态与命令式编程
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#id18">
         1.2  函数式编程
        </a>
       </li>
      </ul>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id19">
       2  一等函数
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#id20">
         2.1  高阶函数
        </a>
        <ul class="nav section-nav flex-column">
         <li class="toc-h5 nav-item toc-entry">
          <a class="reference internal nav-link" href="#map">
           2.1.1
           <code class="docutils literal notranslate">
            <span class="pre">
             map
            </span>
           </code>
           映射
          </a>
         </li>
         <li class="toc-h5 nav-item toc-entry">
          <a class="reference internal nav-link" href="#filter">
           2.1.2
           <code class="docutils literal notranslate">
            <span class="pre">
             filter
            </span>
           </code>
           过滤器
          </a>
         </li>
         <li class="toc-h5 nav-item toc-entry">
          <a class="reference internal nav-link" href="#reduce">
           2.1.3
           <code class="docutils literal notranslate">
            <span class="pre">
             reduce
            </span>
           </code>
           递推
          </a>
         </li>
         <li class="toc-h5 nav-item toc-entry">
          <a class="reference internal nav-link" href="#zip">
           2.1.4
           <code class="docutils literal notranslate">
            <span class="pre">
             zip
            </span>
           </code>
           并行
          </a>
         </li>
         <li class="toc-h5 nav-item toc-entry">
          <a class="reference internal nav-link" href="#sorted">
           2.1.5
           <code class="docutils literal notranslate">
            <span class="pre">
             sorted
            </span>
           </code>
           排序
          </a>
         </li>
        </ul>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#partial">
         2.2
         <code class="docutils literal notranslate">
          <span class="pre">
           partial
          </span>
         </code>
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#id21">
         2.3  匿名函数
        </a>
        <ul class="nav section-nav flex-column">
         <li class="toc-h5 nav-item toc-entry">
          <a class="reference internal nav-link" href="#lambda-def">
           <code class="docutils literal notranslate">
            <span class="pre">
             lambda
            </span>
           </code>
           &amp;
           <code class="docutils literal notranslate">
            <span class="pre">
             def
            </span>
           </code>
          </a>
         </li>
        </ul>
       </li>
      </ul>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#decorator">
       函数修饰器（Decorator）其他相关知识
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id22">
     作用：
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id23">
     示例
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#hello-world">
       添加水印
       <code class="docutils literal notranslate">
        <span class="pre">
         Hello
        </span>
        <span class="pre">
         World_
        </span>
       </code>
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                 <div class="tex2jax_ignore mathjax_ignore section" id="id1">
<h1>函数基础<a class="headerlink" href="#id1" title="永久链接至标题">¶</a></h1>
<p>一个函数就是将一些语句集合在一起的部件，它们能够不止一次地在程序中运行。函数的主要作用：</p>
<ul class="simple">
<li><p>最大化的代码重用和最小化代码冗余</p></li>
<li><p>流程的分解</p></li>
</ul>
<p>一般地，函数讲的流程是：告诉你怎样去做某事，而不是让你使用它去做某事。</p>
<p>Python 中的 <code class="docutils literal notranslate"><span class="pre">def</span></code> 语句实际上是一个可执行的语句：当它运行时，它会创建一个新的函数对象并将其赋值给一个变量名。因为它是一个语句，一个 <code class="docutils literal notranslate"><span class="pre">def</span></code> 可以出现任一语句可以出现的地方——甚至是嵌套在其他的语句中。例如，下面的使用也是合法的：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">test</span> <span class="o">=</span> <span class="o">...</span>
<span class="k">if</span> <span class="n">test</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">func</span><span class="p">():</span>
        <span class="o">...</span>
<span class="k">else</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">func</span><span class="p">():</span>
        <span class="o">...</span>
<span class="o">...</span>
<span class="n">func</span><span class="p">()</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">def</span></code> 在运行时才进行评估，而在 <code class="docutils literal notranslate"><span class="pre">def</span></code> 之中的代码在函数调用后才会评估。</p>
<div class="section" id="python">
<h2>Python 中的多态<a class="headerlink" href="#python" title="永久链接至标题">¶</a></h2>
<p>下面以一个 <code class="docutils literal notranslate"><span class="pre">times()</span></code> 函数为例来说明：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">times</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">x</span> <span class="o">*</span> <span class="n">y</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">times</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
<p>结果：</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>10
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">times</span><span class="p">(</span><span class="mf">3.14</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
<p>结果：</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>12.56
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">times</span><span class="p">(</span><span class="s1">&#39;Ni&#39;</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
<p>结果：</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&#39;NiNiNiNi&#39;
</pre></div>
</div>
<p>从上面我们可以看出：<code class="docutils literal notranslate"><span class="pre">times</span></code> 函数中表达式 <code class="docutils literal notranslate"><span class="pre">x*y</span></code> 的意义完全取决于 <code class="docutils literal notranslate"><span class="pre">x</span></code> 与 <code class="docutils literal notranslate"><span class="pre">y</span></code> 的对象类型。这种依赖类型的行为称为<strong>多态</strong>。任何支持函数所预期的<strong>接口</strong> (函数所执行的一组方法和表达式运算符) 都能够被函数所支持。</p>
</div>
<div class="section" id="id2">
<h2>作用域<a class="headerlink" href="#id2" title="永久链接至标题">¶</a></h2>
<p>当你在一个程序中使用变量名时，Python 创建、改变或查找变量名都是在所谓的<strong>命名空间</strong> (作用域，一个保存变量名的地方) 中进行的。也就是说，在代码中变量名被赋值的位置决定了这个变量名能被访问到的范围。包括作用域的定义在内，所有变量名都是在 Python 赋值时产生的。</p>
<ul class="simple">
<li><p>内嵌的模块是全局作用域</p></li>
<li><p>全局作用域的作用范围仅限于单个文件</p></li>
<li><p>每次对函数的调用都创建了一个新的本地作用域</p></li>
<li><p>赋值的变量名除非声明为 <code class="docutils literal notranslate"><span class="pre">global</span></code> 或者 <code class="docutils literal notranslate"><span class="pre">nonlocal</span></code>，否则均为本地变量</p></li>
<li><p>所有其他的变量名都可以归纳为本地、全局或者内置的</p></li>
<li><p>对函数的每次调用都会创建一个新的本地作用域</p></li>
</ul>
<p>对对象的就地更改（in-place changes）不将变量归类为局部变量;只有实际的名称分配。例如, 如果将名称 <code class="docutils literal notranslate"><span class="pre">L</span></code> 分配给模块顶层的列表, 函数中的语句 <code class="docutils literal notranslate"><span class="pre">L</span> <span class="pre">=</span> <span class="pre">X</span></code> 会将 <code class="docutils literal notranslate"><span class="pre">L</span></code> 作为本地分类, 但 <code class="docutils literal notranslate"><span class="pre">L.append(X)</span></code> 不会。在后一种情况下, 我们正在更改 <code class="docutils literal notranslate"><span class="pre">L</span></code> 引用的 <code class="docutils literal notranslate"><span class="pre">list</span></code> 对象, 而不是 <code class="docutils literal notranslate"><span class="pre">L</span></code> 本身在全局范围中像往常一样被发现, 并且 Python 在不需要全局 (或非本地) 声明的情况下愉快地修改它。与往常一样, 它有助于保持名称和对象之间的区分清楚: <strong>更改对象不是对名称的赋值。</strong></p>
</div>
<div class="section" id="name-resolution-the-legb-rule">
<h2>Name Resolution: The LEGB Rule<a class="headerlink" href="#name-resolution-the-legb-rule" title="永久链接至标题">¶</a></h2>
<p>变量名解析：LEGB 原则</p>
<ul class="simple">
<li><p>Name assignments create or change local names by default.</p></li>
<li><p>Name references search at most four scopes: local, then enclosing functions (if any), then global, then built-in.</p></li>
<li><p>Names declared in global and nonlocal statements map assigned names to enclosing module and function scopes, respectively.</p></li>
</ul>
<p><img alt="" src="https://img2018.cnblogs.com/blog/685754/201810/685754-20181028190908768-1099229425.jpg" /></p>
</div>
<div class="section" id="id3">
<h2>工厂函数<a class="headerlink" href="#id3" title="永久链接至标题">¶</a></h2>
<p><strong>闭合</strong> (closure) 或者工厂函数：一个能够记住嵌套作用域的变量值的函数，尽管那个作用域或许已经不存在了。</p>
<p>例如，工厂函数有时用于需要及时生成事件处理、实时对不同情况进行反馈的程序中：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">maker</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">action</span><span class="p">(</span><span class="n">X</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">X</span> <span class="o">**</span> <span class="n">N</span>
    <span class="k">return</span> <span class="n">action</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="n">maker</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>  <span class="c1"># pass 2 to N</span>
<span class="n">f</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;function __main__.maker.&lt;locals&gt;.action(X)&gt;
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>9
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>16
</pre></div>
</div>
</div>
<div class="section" id="id4">
<h2>函数的不定长参数<a class="headerlink" href="#id4" title="永久链接至标题">¶</a></h2>
<p>当函数的参数不确定时，可以使用<code class="docutils literal notranslate"><span class="pre">*args</span></code> 和<code class="docutils literal notranslate"><span class="pre">**kwargs</span></code>.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">*args</span></code> 是可变的 positional arguments 列表(表示任何多个无名参数，它是一个 tuple)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">**kwargs</span></code> 是可变的 keyword arguments 列表(表示关键字参数，它是一个 dict)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">*args</span></code>  必须位于 <code class="docutils literal notranslate"><span class="pre">**kwargs</span></code> 之前，因为 positional arguments 必须位于 keyword arguments 之前。</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">print_everything</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">count</span><span class="p">,</span> <span class="n">thing</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">args</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">((</span><span class="s2">&quot;</span><span class="si">%d</span><span class="s2">. </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">count</span><span class="p">,</span> <span class="n">thing</span><span class="p">)))</span>


<span class="n">print_everything</span><span class="p">(</span><span class="s1">&#39;apple&#39;</span><span class="p">,</span> <span class="s1">&#39;banana&#39;</span><span class="p">,</span> <span class="s1">&#39;cabbage&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>0. apple
1. banana
2. cabbage
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">table_things</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="s2">&quot;=&quot;</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>


<span class="n">table_things</span><span class="p">(</span><span class="n">apple</span><span class="o">=</span><span class="s1">&#39;fruit&#39;</span><span class="p">,</span> <span class="n">cabbage</span><span class="o">=</span><span class="s1">&#39;vegetable&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>apple = fruit
cabbage = vegetable
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">foo</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;args=&#39;</span><span class="p">,</span><span class="n">args</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;kwargs=&#39;</span><span class="p">,</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
    
<span class="k">if</span> <span class="vm">__name__</span><span class="o">==</span><span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">foo</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
    <span class="n">foo</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">b</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">c</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">foo</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="n">a</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">b</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">c</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">foo</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="kc">None</span><span class="p">,</span><span class="n">a</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">b</span><span class="o">=</span><span class="s1">&#39;2&#39;</span><span class="p">,</span><span class="n">c</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>args= (1, 2, 3, 4)
kwargs= {}
 
args= ()
kwargs= {&#39;a&#39;: 1, &#39;b&#39;: 2, &#39;c&#39;: 3}
 
args= (1, 2, 3, 4)
kwargs= {&#39;a&#39;: 1, &#39;b&#39;: 2, &#39;c&#39;: 3}
 
args= (&#39;a&#39;, 1, None)
kwargs= {&#39;a&#39;: 1, &#39;b&#39;: &#39;2&#39;, &#39;c&#39;: 3}
</pre></div>
</div>
<p>python 可以自动将参数解析后再与调用的函数匹配。</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">print_three_things</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;a =&quot;</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="s2">&quot;&amp; b =&quot;</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="s2">&quot;&amp; c =&quot;</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>


<span class="n">mylist</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;aardvark&#39;</span><span class="p">,</span> <span class="s1">&#39;baboon&#39;</span><span class="p">,</span> <span class="s1">&#39;cat&#39;</span><span class="p">]</span>
<span class="n">print_three_things</span><span class="p">(</span><span class="o">*</span><span class="n">mylist</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>a = aardvark &amp; b = baboon &amp; c = cat
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># 还有一个很漂亮的用法，就是创建字典：</span>
<span class="k">def</span> <span class="nf">kw_dict</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">kwargs</span>


<span class="nb">print</span><span class="p">(</span><span class="n">kw_dict</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="mi">3</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>{&#39;a&#39;: 1, &#39;b&#39;: 2, &#39;c&#39;: 3}
</pre></div>
</div>
</div>
<div class="section" id="id5">
<h2>函数设计原则<a class="headerlink" href="#id5" title="永久链接至标题">¶</a></h2>
<ul class="simple">
<li><p>耦合性</p>
<ul>
<li><p><strong>对于输入使用参数并且对于输出使用 <code class="docutils literal notranslate"><span class="pre">return</span></code> 语句</strong>：一般地，你需要力求让函数独立于它外部的东西。参数和 <code class="docutils literal notranslate"><span class="pre">return</span></code> 语句通常就是隔离对代码中少数醒目位置的外部依赖关系的最好方法。</p></li>
<li><p><strong>只有在真正必要的情况下使用全局变量</strong>：全局变量可能会引发依赖关系和计时问题，导致程序调试和修改的困难。</p></li>
<li><p><strong>不要改变可变类型的参数，除非调用者需要这样做</strong>：这种耦合性会导致一个函数过于特殊和不友好。</p></li>
</ul>
</li>
<li><p>聚合性</p>
<ul>
<li><p><strong>每一个函数都应该有一个单一的、统一的目标</strong>：在设计完美的情况下，每一个函数都应该做一件事：这件事可以用一个简单说明句来总结。（这样做可以提高代码的开发效率）</p></li>
</ul>
</li>
<li><p>大小</p>
<ul>
<li><p><strong>每一个函数都应该相对较小</strong>：保持简单，提高代码的可读性和扩展性。</p></li>
</ul>
</li>
<li><p>耦合</p>
<ul>
<li><p><strong>避免直接改变在另一个模块文件中的变量</strong>：提高代码的可读性和扩展性。</p></li>
</ul>
</li>
</ul>
<p>简言之，我们应该竭力使函数和其他编程组件中的外部依赖性最小化。函数的自我包含性越好，它就越容易被理解、复用和修改。</p>
</div>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="id6">
<h1>递归（程序调用自身的编程技巧）<a class="headerlink" href="#id6" title="永久链接至标题">¶</a></h1>
<p>递归通常把一个大型复杂的问题，转化为一个与原问题相似的，且规模较小的问题来求解。<br />
递归策略只需少量的程序就可以描述出解题的所需的多次重复计算，大大减少了程序的代码量。</p>
<p>递归函数一般包括：</p>
<ul class="simple">
<li><p>当函数直接结束是时有基本的返回值。</p></li>
<li><p>递归调用函数自身：包括一个或多个对自身函数的调用。</p></li>
</ul>
<div class="section" id="n">
<h2>求 <span class="math notranslate nohighlight">\(n!\)</span><a class="headerlink" href="#n" title="永久链接至标题">¶</a></h2>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">Factorial</span><span class="p">(</span><span class="n">a</span><span class="p">):</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">a</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">a</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">*=</span> <span class="n">i</span>
    <span class="k">return</span> <span class="n">result</span>


<span class="c1"># 调用函数</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Factorial</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>3628800
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># 递归函数</span>
<span class="k">def</span> <span class="nf">Recursion</span><span class="p">(</span><span class="n">a</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">a</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">1</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">a</span><span class="o">*</span><span class="n">Recursion</span><span class="p">(</span><span class="n">a</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>


<span class="n">Recursion</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>3628800
</pre></div>
</div>
</div>
<div class="section" id="id7">
<h2>求序列的和<a class="headerlink" href="#id7" title="永久链接至标题">¶</a></h2>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">seq_sum</span><span class="p">(</span><span class="n">L</span><span class="p">):</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">L</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">0</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">L</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">seq_sum</span><span class="p">(</span><span class="n">L</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>


<span class="n">seq_sum</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>15
</pre></div>
</div>
<p>为了更好的理解上面的代码，我们可以借助 <code class="docutils literal notranslate"><span class="pre">print</span></code> 函数：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">seq_sum</span><span class="p">(</span><span class="n">L</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;*&#39;</span><span class="o">*</span><span class="mi">30</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">L</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">L</span><span class="p">:</span>
        <span class="n">s</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">L</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">seq_sum</span><span class="p">(</span><span class="n">L</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;&gt;&#39;</span><span class="o">*</span><span class="mi">30</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">L</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="o">*</span><span class="mi">30</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">s</span>


<span class="n">seq_sum</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>******************************
[1, 2, 3, 4, 5]
******************************
[2, 3, 4, 5]
******************************
[3, 4, 5]
******************************
[4, 5]
******************************
[5]
******************************
[]
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
[]
------------------------------
0
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
[5]
------------------------------
5
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
[4, 5]
------------------------------
9
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
[3, 4, 5]
------------------------------
12
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
[2, 3, 4, 5]
------------------------------
14
&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
[1, 2, 3, 4, 5]
------------------------------
15





15
</pre></div>
</div>
<p>从打印的结果可以看出：Python 中的递归是以<strong>堆栈</strong>的形式来实现的。我们可以利用解包技术来进一步简化递归函数：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">seq_sum</span><span class="p">(</span><span class="n">L</span><span class="p">):</span>
    <span class="k">return</span> <span class="mi">0</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">L</span> <span class="k">else</span> <span class="n">L</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">seq_sum</span><span class="p">(</span><span class="n">L</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>   <span class="c1"># 仅仅适用数值型</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">seq_sum</span><span class="p">(</span><span class="n">L</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">L</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">L</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="n">L</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">seq_sum</span><span class="p">(</span><span class="n">L</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>  <span class="c1"># 适用更多的类型</span>


<span class="c1"># 更好的写法</span>
<span class="k">def</span> <span class="nf">seq_sum</span><span class="p">(</span><span class="n">L</span><span class="p">):</span>
    <span class="n">first</span><span class="p">,</span> <span class="o">*</span><span class="n">rest</span> <span class="o">=</span> <span class="n">L</span>
    <span class="k">return</span> <span class="n">first</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">rest</span> <span class="k">else</span> <span class="n">first</span> <span class="o">+</span> <span class="n">seq_sum</span><span class="p">(</span><span class="n">rest</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="functional-programming">
<h1>函数式编程（Functional programming）<a class="headerlink" href="#functional-programming" title="永久链接至标题">¶</a></h1>
<p>参考资料：</p>
<ul class="simple">
<li><p><a class="reference external" href="http://www.ruanyifeng.com/blog/2017/02/fp-tutorial.html">函数式编程入门教程</a></p></li>
<li><p><a class="reference external" href="http://www.cnblogs.com/xiami303/archive/2012/05/31/2528588.html">python —函数式编程指南【转】</a></p></li>
</ul>
<div class="section" id="id8">
<h2>什么是函数式编程？<a class="headerlink" href="#id8" title="永久链接至标题">¶</a></h2>
<blockquote>
<div><p>函数式编程使用一系列的函数解决问题。函数仅接受输入并产生输出，不包含任何能影响产生输出的内部状态。任何情况下，使用相同的参数调用函数始终能产生同样的结果。
在一个函数式的程序中，输入的数据“流过”一系列的函数，每一个函数根据它的输入产生输出。函数式风格避免编写有“边界效应”(side effects)的函数：修改内部状态，或者是其他无法反应在输出上的变化。完全没有边界效应的函数被称为“纯函数式的”(purely functional)。避免边界效应意味着不使用在程序运行时可变的数据结构，输出只依赖于输入。<br />
可以认为函数式编程刚好站在了面向对象编程的对立面。对象通常包含内部状态（字段），和许多能修改这些状态的函数，程序则由不断修改状态构成；函数式编程则极力避免状态改动，并通过在函数间传递数据流进行工作。但这并不是说无法同时使用函数式编程和面向对象编程，事实上，复杂的系统一般会采用面向对象技术建模，但混合使用函数式风格还能让你额外享受函数式风格的优点。</p>
</div></blockquote>
</div>
<div class="section" id="id9">
<h2>为什么使用函数式编程？<a class="headerlink" href="#id9" title="永久链接至标题">¶</a></h2>
<blockquote>
<div><p>函数式的风格通常被认为有如下优点：</p>
</div></blockquote>
<ul class="simple">
<li><p><strong>逻辑可证</strong>:
这是一个学术上的优点：没有边界效应使得更容易从逻辑上证明程序是正确的（而不是通过测试）。</p></li>
<li><p><strong>模块化</strong>:
函数式编程推崇简单原则，一个函数只做一件事情，将大的功能拆分成尽可能小的模块。小的函数更易于阅读和检查错误。</p></li>
<li><p><strong>组件化</strong>:
小的函数更容易加以组合形成新的功能。</p></li>
<li><p><strong>易于调试</strong>:
细化的、定义清晰的函数使得调试更加简单。当程序不正常运行时，每一个函数都是检查数据是否正确的接口，能更快速地排除没有问题的代码，定位到出现问题的地方。</p></li>
<li><p><strong>易于测试</strong>:
不依赖于系统状态的函数无须在测试前构造测试桩，使得编写单元测试更加容易。</p></li>
<li><p><strong>更高的生产率</strong>:
函数式编程产生的代码比其他技术更少（往往是其他技术的一半左右），并且更容易阅读和维护。</p></li>
</ul>
</div>
<div class="section" id="id10">
<h2>如何辨认函数式风格？<a class="headerlink" href="#id10" title="永久链接至标题">¶</a></h2>
<blockquote>
<div><p>支持函数式编程的语言通常具有如下特征，大量使用这些特征的代码即可被认为是函数式的：</p>
</div></blockquote>
<ul class="simple">
<li><p><strong>函数是一等公民</strong>:<br />
函数能作为参数传递，或者是作为返回值返回。这个特性使得模板方法模式非常易于编写，这也促使了这个模式被更频繁地使用。
以一个简单的集合排序为例，假设lst是一个数集，并拥有一个排序方法sort需要将如何确定顺序作为参数。
如果函数不能作为参数，那么lst的sort方法只能接受普通对象作为参数。这样一来我们需要首先定义一个接口，然后定义一个实现该接口的类，最后将该类的一个实例传给sort方法，由sort调用这个实例的compare方法，就像这样：</p></li>
</ul>
<p>函数式编程的起源，是一门叫做范畴论（Category Theory）的数学分支。<br />
理解函数式编程的关键，就是理解范畴论。它是一门很复杂的数学，认为世界上所有的概念体系，都可以抽象成一个个的”范畴”（category）。</p>
<p>1 范畴的概念</p>
<blockquote>
<div><p>“范畴就是使用箭头连接的物体。“彼此之间存在某种关系的概念、事物、对象等等，都构成”范畴”。随便什么东西，只要能找出它们之间的关系，就能定义一个”范畴”。<br />
箭头表示范畴成员之间的关系，正式的名称叫做”态射”（morphism）。范畴论认为，同一个范畴的所有成员，就是不同状态的”变形”（transformation）。通过”态射”，一个成员可以变形成另一个成员。</p>
</div></blockquote>
<p>2 数学模型</p>
<blockquote>
<div><p>既然”范畴”是满足某种变形关系的所有对象，就可以总结出它的数学模型。</p>
</div></blockquote>
<ul class="simple">
<li><p>所有成员是一个集合</p></li>
<li><p>变形关系是函数</p></li>
</ul>
<p>也就是说，范畴论是集合论更上层的抽象，简单的理解就是<code class="docutils literal notranslate"><span class="pre">&quot;集合</span> <span class="pre">+</span> <span class="pre">函数&quot;</span></code>。
理论上通过函数，就可以从范畴的一个成员，算出其他所有成员。</p>
<p>3 范畴与容器</p>
<p>我们可以把”范畴”想象成是一个容器，里面包含两样东西。</p>
<ul class="simple">
<li><p>值（value）</p></li>
<li><p>值的变形关系，也就是函数。</p></li>
</ul>
<p>本质上，函数式编程只是范畴论的运算方法，跟数理逻辑、微积分、行列式是同一类东西，都是数学方法，只是碰巧它能用来写程序。</p>
<blockquote>
<div><p>在函数式编程中，函数就是一个管道（pipe）。这头进去一个值，那头就会出来一个新的值，没有其他副作用。</p>
</div></blockquote>
</div>
<div class="section" id="id11">
<h2>函数的合成与柯里化<a class="headerlink" href="#id11" title="永久链接至标题">¶</a></h2>
<p>函数式编程有两个最基本的运算：合成和柯里化。</p>
<div class="section" id="id12">
<h3>函数的合成:<a class="headerlink" href="#id12" title="永久链接至标题">¶</a></h3>
<p>如果一个值要经过多个函数，才能变成另外一个值，就可以把所有中间步骤合并成一个函数，这叫做”函数的合成”（compose）。<br />
函数合成就是将那些管道(pipe)连了起来，让数据一口气从多个管道中穿过。</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">g</span><span class="p">():</span>
        <span class="k">return</span> <span class="n">x</span><span class="o">+</span><span class="mi">1</span>
    <span class="k">return</span> <span class="n">g</span><span class="p">()</span><span class="o">*</span><span class="mi">5</span>

<span class="n">f</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>20
</pre></div>
</div>
</div>
<div class="section" id="id13">
<h3>柯里化:<a class="headerlink" href="#id13" title="永久链接至标题">¶</a></h3>
<p><span class="math notranslate nohighlight">\(f(x)\)</span> 和<span class="math notranslate nohighlight">\(g(x)\)</span> 合成为 <span class="math notranslate nohighlight">\(f(g(x))\)</span>，有一个隐藏的前提，就是 <span class="math notranslate nohighlight">\(f\)</span> 和 <span class="math notranslate nohighlight">\(g\)</span> 都只能接受一个参数。如果可以接受多个参数，比如 <span class="math notranslate nohighlight">\(f(x, y)\)</span> 和 <span class="math notranslate nohighlight">\(g(a, b, c)\)</span>，函数合成就非常麻烦。 这时就需要函数柯里化了。</p>
<p><strong>所谓”柯里化”，就是把一个多参数的函数，转化为单参数函数。</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># 柯里化之前</span>
<span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span>

<span class="n">add</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>3
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># 柯里化之后</span>
<span class="k">def</span> <span class="nf">addX</span><span class="p">(</span><span class="n">y</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span>
    <span class="k">return</span> <span class="n">f</span>


<span class="n">addX</span><span class="p">(</span><span class="mi">2</span><span class="p">)(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>3
</pre></div>
</div>
<p>有了柯里化以后，我们就能做到，所有函数只接受一个参数。后文的内容除非另有说明，都默认函数只有一个参数，就是所要处理的那个值。</p>
</div>
<div class="section" id="id14">
<h3>函子<a class="headerlink" href="#id14" title="永久链接至标题">¶</a></h3>
<p>函数不仅可以用于同一个范畴之中值的转换，还可以用于将一个范畴转成另一个范畴。这就涉及到了函子（Functor）。</p>
<p>函子是函数式编程里面最重要的数据类型，也是基本的运算单位和功能单位。</p>
<p>它首先是一种范畴，也就是说，是一个容器，包含了值和变形关系。比较特殊的是，它的变形关系可以依次作用于每一个值，将当前容器变形成另一个容器。</p>
<p><strong>一般约定，函子的标志就是容器具有 <code class="docutils literal notranslate"><span class="pre">map</span></code> 方法。该方法将容器里面的每一个值，映射到另一个容器。</strong> 函子，一般还有有 <code class="docutils literal notranslate"><span class="pre">filter</span></code> 、<code class="docutils literal notranslate"><span class="pre">reduce</span></code>.</p>
<p><code class="docutils literal notranslate"><span class="pre">filter</span></code> 用于<strong>过滤</strong>列表对象，返回真值的原像，类似于<strong>逆映射</strong>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span>


<span class="k">def</span> <span class="nf">even</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">x</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;map(even, range(10))：&#39;</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">even</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">))))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;filter(even, range(15))：&#39;</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="nb">filter</span><span class="p">(</span><span class="n">even</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">15</span><span class="p">))))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;filter(f, range(10))：&#39;</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="nb">filter</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">))))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;map(f,range(10))：&#39;</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">))))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;map(lambda x:x**2,range(10))：&#39;</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span><span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">))))</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>map(even, range(10))： [True, False, True, False, True, False, True, False, True, False]
filter(even, range(15))： [0, 2, 4, 6, 8, 10, 12, 14]
filter(f, range(10))： [1, 2, 3, 4, 5, 6, 7, 8, 9]
map(f,range(10))： [0, 1, 4, 9, 16, 25, 36, 49, 64, 81]
map(lambda x:x**2,range(10)))： [0, 1, 4, 9, 16, 25, 36, 49, 64, 81]
</pre></div>
</div>
</div>
</div>
<div class="section" id="id15">
<h2>函数柯里化<a class="headerlink" href="#id15" title="永久链接至标题">¶</a></h2>
<p>一个函数有多个参数，我们希望能固定其中几个参数的值。</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">partial</span>


<span class="k">def</span> <span class="nf">foo</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span> <span class="o">+</span> <span class="n">c</span>


<span class="n">foo2</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">foo</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">foo2</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>6
</pre></div>
</div>
<p>看上去这跟提供参数默认值的情况类似。但默认值只能固定
为单个值，而柯里化能通过泛化出很多个函数，每个函数用
不同的固定值，来看一下 应用场景</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">partial</span>
<span class="n">bin2dec</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">base</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">hex2dec</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">base</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
</pre></div>
</div>
<p>原 <code class="docutils literal notranslate"><span class="pre">int</span></code> 方法的定义为：<code class="docutils literal notranslate"><span class="pre">int(</span> <span class="pre">x[,</span> <span class="pre">base])</span></code>，<code class="docutils literal notranslate"><span class="pre">base</span></code> 参数的默认为 <code class="docutils literal notranslate"><span class="pre">10</span></code>，经过柯里化之后，可以用如下方式调用：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">int</span><span class="p">(</span><span class="s1">&#39;15&#39;</span><span class="p">)</span>  <span class="c1">#=&gt;15  using default base 10</span>
<span class="nb">print</span><span class="p">(</span><span class="n">bin2dec</span><span class="p">(</span><span class="s1">&#39;01011&#39;</span><span class="p">))</span>  <span class="c1">#=&gt;11</span>
<span class="nb">print</span><span class="p">(</span><span class="n">hex2dec</span><span class="p">(</span><span class="s1">&#39;67&#39;</span><span class="p">))</span>  <span class="c1">#=&gt;103</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>11
103
</pre></div>
</div>
</div>
<div class="section" id="uncurrying">
<h2>反柯里化(Uncurrying)<a class="headerlink" href="#uncurrying" title="永久链接至标题">¶</a></h2>
<p>顾名思义，是柯里化的逆过程。将多个只含单个参数的函数模拟成一个多参数函数。你可以像这样调用：<code class="docutils literal notranslate"><span class="pre">foo(1)(4)</span></code> 或 <code class="docutils literal notranslate"><span class="pre">(foo(1))(4)</span></code>，都能得到正确的结果 <code class="docutils literal notranslate"><span class="pre">5</span></code></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">foo</span><span class="p">(</span><span class="n">a</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">bar</span><span class="p">(</span><span class="n">b</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span>

    <span class="k">return</span> <span class="n">bar</span>

<span class="n">foo</span><span class="p">(</span><span class="mi">1</span><span class="p">)(</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>5
</pre></div>
</div>
<p>上接 <a class="reference external" href="https://www.cnblogs.com/q735613050/p/7347181.html">python 函数式编程学习笔记</a></p>
<p>参考：www.sigai.cn/</p>
<div class="section" id="id16">
<h3>1  函数式编程概述<a class="headerlink" href="#id16" title="永久链接至标题">¶</a></h3>
<ul class="simple">
<li><p>前提：函数在 Python 中是⼀等对象</p></li>
<li><p>工具：<strong>built-in</strong> ⾼阶函数；<strong>lambda</strong> 函数；<strong>operator</strong> 模块；<strong>functools</strong> 模块</p></li>
<li><p>模式：闭包与装饰器</p></li>
<li><p>替代：⽤用 List Comprehension 可轻松替代 map 和 ﬁlter（reduce 替代起来⽐比较困难）</p></li>
<li><p>原则：<strong>No Side Eﬀect</strong></p></li>
</ul>
<blockquote>
<div><p>何为 No Side Eﬀect？ 函数的所有功能就仅仅是返回一个新的值而已，没有其他行为，尤其是不得修改外部变量。因⽽，各个独⽴的部分的执⾏顺序可以随意打乱，带来执⾏顺序上的⾃自使得⼀系列新的特性得以实现：⽆锁的并发；惰性求值；编译器器级别的性能优化等</p>
</div></blockquote>
<div class="section" id="id17">
<h4>1.1  程序的状态与命令式编程<a class="headerlink" href="#id17" title="永久链接至标题">¶</a></h4>
<ul class="simple">
<li><p>程序的状态首先包含了当前定义的全部变量</p></li>
<li><p>有了程序的状态，我们的程序才能不断往前推进</p></li>
<li><p>命令式编程，就是通过不断修改变量的值，来保存当前运⾏的状态，来步步推进</p></li>
</ul>
</div>
<div class="section" id="id18">
<h4>1.2  函数式编程<a class="headerlink" href="#id18" title="永久链接至标题">¶</a></h4>
<ul class="simple">
<li><p>通过函数来保存程序的状态（通过函数创建新的参数和返回值来保存状态）</p></li>
<li><p>函数一层层的叠加起来，每个函数的参数或返回值代表了⼀个中间状态</p></li>
<li><p>命令式编程⾥一次变量值的修改，在函数式编程⾥变成了⼀个函数的转换</p></li>
<li><p>最自然的方式：递归</p></li>
</ul>
</div>
</div>
<div class="section" id="id19">
<h3>2  一等函数<a class="headerlink" href="#id19" title="永久链接至标题">¶</a></h3>
<p><strong>一等对象</strong>的定义：</p>
<ul class="simple">
<li><p>在运⾏时创建</p></li>
<li><p>能赋值给变量或数据结构中的元素</p></li>
<li><p>能作为参数传给函数</p></li>
<li><p>能作为函数的返回结果</p></li>
</ul>
<p>Python 中，所有函数的都是一等对象，简称为<strong>一等函数</strong></p>
<div class="section" id="id20">
<h4>2.1  高阶函数<a class="headerlink" href="#id20" title="永久链接至标题">¶</a></h4>
<p>定义：接受函数为参数，或把函数作为返回结果的函数</p>
<div class="section" id="map">
<h5>2.1.1  <code class="docutils literal notranslate"><span class="pre">map</span></code> 映射<a class="headerlink" href="#map" title="永久链接至标题">¶</a></h5>
<p><code class="docutils literal notranslate"><span class="pre">map()</span></code> 是 Python 内置的高阶函数，它接收一个函数 <code class="docutils literal notranslate"><span class="pre">f</span></code> 和一个<strong>可迭代对象</strong>，并通过把函数 <code class="docutils literal notranslate"><span class="pre">f</span></code> 依次作用在 可迭代对象 的每个元素上，并返回一个新的可迭代对象。</p>
<hr class="docutils" />
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">x</span> <span class="o">*</span> <span class="n">x</span>


<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;map(f, [1, 2, 3, 4, 5, 6, 7, 8, 9])):&#39;</span><span class="p">,</span>
      <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">])))</span>
</pre></div>
</div>
<p>show：</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>map(f, [1, 2, 3, 4, 5, 6, 7, 8, 9])): [1, 4, 9, 16, 25, 36, 49, 64, 81]
</pre></div>
</div>
<p>替代方案：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">x</span><span class="o">*</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">)]</span>
</pre></div>
</div>
<hr class="docutils" />
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">format_name</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
    <span class="n">s1</span> <span class="o">=</span> <span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">+</span> <span class="n">s</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">s1</span>


<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;map(format_name, [&#39;adam&#39;, &#39;LISA&#39;, &#39;barT&#39;]):&quot;</span><span class="p">,</span>
      <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">format_name</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;adam&#39;</span><span class="p">,</span> <span class="s1">&#39;LISA&#39;</span><span class="p">,</span> <span class="s1">&#39;barT&#39;</span><span class="p">])))</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>map(format_name, [&#39;adam&#39;, &#39;LISA&#39;, &#39;barT&#39;]): [&#39;Adam&#39;, &#39;Lisa&#39;, &#39;Bart&#39;]
</pre></div>
</div>
<p>替代方案：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">format_name</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">name</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">([</span><span class="s1">&#39;adam&#39;</span><span class="p">,</span> <span class="s1">&#39;LISA&#39;</span><span class="p">,</span> <span class="s1">&#39;barT&#39;</span><span class="p">])]</span>
</pre></div>
</div>
<p>因而，列表推导可以很好的替换 map 函数。</p>
</div>
<div class="section" id="filter">
<h5>2.1.2  <code class="docutils literal notranslate"><span class="pre">filter</span></code> 过滤器<a class="headerlink" href="#filter" title="永久链接至标题">¶</a></h5>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="p">[(),</span> <span class="p">[],</span> <span class="p">{},</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">]</span>

<span class="n">x_result</span> <span class="o">=</span> <span class="nb">filter</span><span class="p">(</span><span class="nb">bool</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> 
<span class="nb">list</span><span class="p">(</span><span class="n">x_result</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[True, 1, 2, -3]
</pre></div>
</div>
<p>替代方案：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">x</span> <span class="k">if</span> <span class="nb">bool</span><span class="p">(</span><span class="n">i</span><span class="p">)]</span>
</pre></div>
</div>
<hr class="docutils" />
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;filter((lambda x: x&gt;0), range(-5, 5)):&quot;</span><span class="p">,</span>
      <span class="nb">list</span><span class="p">(</span><span class="nb">filter</span><span class="p">((</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">),</span> <span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))))</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>filter((lambda x: x&gt;0), range(-5, 5)): [1, 2, 3, 4]
</pre></div>
</div>
<p>替代方案：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span> <span class="k">if</span> <span class="n">x</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="section" id="reduce">
<h5>2.1.3  <code class="docutils literal notranslate"><span class="pre">reduce</span></code> 递推<a class="headerlink" href="#reduce" title="永久链接至标题">¶</a></h5>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">reduce</span>

<span class="n">m</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">reduce</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">x</span> <span class="o">*</span> <span class="n">y</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)),</span> <span class="n">m</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>240
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">multiply</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">a</span> <span class="o">*</span> <span class="n">b</span>


<span class="n">reduce</span><span class="p">(</span><span class="n">multiply</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>24
</pre></div>
</div>
</div>
<div class="section" id="zip">
<h5>2.1.4  <code class="docutils literal notranslate"><span class="pre">zip</span></code> 并行<a class="headerlink" href="#zip" title="永久链接至标题">¶</a></h5>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;zip( [1, 2, 3], [4, 5, 6]):&quot;</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">])))</span>
</pre></div>
</div>
<p>show：</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>zip( [1, 2, 3], [4, 5, 6]): [(1, 4), (2, 5), (3, 6)]
</pre></div>
</div>
</div>
<div class="section" id="sorted">
<h5>2.1.5  <code class="docutils literal notranslate"><span class="pre">sorted</span></code> 排序<a class="headerlink" href="#sorted" title="永久链接至标题">¶</a></h5>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">sorted</span><span class="p">([</span><span class="n">x</span> <span class="o">*</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">**</span> <span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)])</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[-9, -7, -5, -3, -1, 0, 2, 4, 6, 8] 
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">sorted</span><span class="p">([</span><span class="n">x</span> <span class="o">*</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">**</span> <span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)],</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> 
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[8, 6, 4, 2, 0, -1, -3, -5, -7, -9] 
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">sorted</span><span class="p">([</span><span class="n">x</span> <span class="o">*</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">**</span> <span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)],</span> <span class="n">key</span><span class="o">=</span><span class="nb">abs</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span> [0, -1, 2, -3, 4, -5, 6, -7, 8, -9]
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">sorted</span><span class="p">([</span><span class="n">x</span> <span class="o">*</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">**</span> <span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)],</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="nb">abs</span><span class="p">)</span> 
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[-9, 8, -7, 6, -5, 4, -3, 2, -1, 0]
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">min</span></code> 与 <code class="docutils literal notranslate"><span class="pre">max</span></code> 同理。</p>
</div>
</div>
<div class="section" id="partial">
<h4>2.2  <code class="docutils literal notranslate"><span class="pre">partial</span></code><a class="headerlink" href="#partial" title="永久链接至标题">¶</a></h4>
<p><code class="docutils literal notranslate"><span class="pre">functools</span></code> 这货用于高阶函数：指那些作用于函数或者返回其他函数的函数。通常情况下，只要是可以被当做函数调用的对象就是这个模块的目标。</p>
<p>假设有如下函数：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">multiply</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">x</span> <span class="o">*</span> <span class="n">y</span>
</pre></div>
</div>
<p>现在，我们想返回某个数的双倍，即：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">multiply</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>6
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">multiply</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>8
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">multiply</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>10
</pre></div>
</div>
<hr class="docutils" />
<p>上面的调用有点繁琐，每次都要传入 <code class="docutils literal notranslate"><span class="pre">y=2</span></code>，我们想到可以定义一个新的函数，把 <code class="docutils literal notranslate"><span class="pre">y=2</span></code> 作为默认值，即：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">double</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">multiply</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
<p>现在，我们可以这样调用了：</p>
<hr class="docutils" />
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">double</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>6
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">double</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>8
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">double</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>10
</pre></div>
</div>
<hr class="docutils" />
<p>事实上，我们可以不用自己定义 <code class="docutils literal notranslate"><span class="pre">double</span></code>，利用 <code class="docutils literal notranslate"><span class="pre">partial</span></code>，我们可以这样：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">partial</span>

<span class="n">double</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">multiply</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">partial</span></code> 接收函数 <code class="docutils literal notranslate"><span class="pre">multiply</span></code> 作为参数，固定 <code class="docutils literal notranslate"><span class="pre">multiply</span></code> 的参数 <code class="docutils literal notranslate"><span class="pre">y=2</span></code>，并返回一个新的函数给 <code class="docutils literal notranslate"><span class="pre">double</span></code>，这跟我们自己定义 <code class="docutils literal notranslate"><span class="pre">double</span></code> 函数的效果是一样的。</p>
<p>所以，简单而言，<code class="docutils literal notranslate"><span class="pre">partial</span></code> 函数的功能就是：<strong>把一个函数的某些参数给固定住，返回一个新的函数。</strong></p>
<p>需要注意的是，我们上面是固定了 <code class="docutils literal notranslate"><span class="pre">multiply</span></code> 的关键字参数 <code class="docutils literal notranslate"><span class="pre">y=2</span></code>，如果直接使用：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">double</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">multiply</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<p>则 <code class="docutils literal notranslate"><span class="pre">2</span></code> 是赋给了 <code class="docutils literal notranslate"><span class="pre">multiply</span></code> 最左边的参数 <code class="docutils literal notranslate"><span class="pre">x</span></code>。</p>
<hr class="docutils" />
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">partial</span>

<span class="k">def</span> <span class="nf">subtraction</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">x</span> <span class="o">-</span> <span class="n">y</span>

<span class="n">f</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">subtraction</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>  <span class="c1"># 4 赋给了 x</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>   <span class="c1"># 4 - 10</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>-6
</pre></div>
</div>
<hr class="docutils" />
<p>组合高阶函数：</p>
<hr class="docutils" />
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">partial</span>

<span class="n">abs_sorted</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="nb">sorted</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="nb">abs</span><span class="p">)</span>
<span class="n">abs_sorted</span><span class="p">([</span><span class="n">x</span> <span class="o">*</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">**</span> <span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)])</span>
</pre></div>
</div>
<p>show:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[0, -1, 2, -3, 4, -5, 6, -7, 8, -9]
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">abs_reverse_sorted</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="nb">sorted</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="nb">abs</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">abs_reverse_sorted</span><span class="p">([</span><span class="n">x</span> <span class="o">*</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">**</span> <span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)])</span>
</pre></div>
</div>
<p>show:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[-9, 8, -7, 6, -5, 4, -3, 2, -1, 0]
</pre></div>
</div>
</div>
<hr class="docutils" />
<div class="section" id="id21">
<h4>2.3  匿名函数<a class="headerlink" href="#id21" title="永久链接至标题">¶</a></h4>
<ul class="simple">
<li><p>定义：使⽤用 <code class="docutils literal notranslate"><span class="pre">lambda</span></code> 表达式创建的函数，函数本身没有名字</p></li>
<li><p>特点：只能使⽤用纯表达式，不能赋值，不能使⽤用 <code class="docutils literal notranslate"><span class="pre">while</span></code> 和 <code class="docutils literal notranslate"><span class="pre">try</span></code> 等块语句</p></li>
<li><p>语法： <code class="docutils literal notranslate"><span class="pre">lambda</span> <span class="pre">[arg1</span> <span class="pre">[,arg2</span> <span class="pre">[,arg3]]]:</span> <span class="pre">expression</span></code></p></li>
</ul>
<blockquote>
<div><p>Expressions get a value; Statements do something</p>
</div></blockquote>
<div class="section" id="lambda-def">
<h5><code class="docutils literal notranslate"><span class="pre">lambda</span></code> &amp; <code class="docutils literal notranslate"><span class="pre">def</span></code><a class="headerlink" href="#lambda-def" title="永久链接至标题">¶</a></h5>
<p>写法上：</p>
<ol class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">def</span></code> 可以用代码块，一个代码块包含多个语句</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">lambda</span></code>只能⽤单行表达式，⽽表达式仅仅是单个语句中的⼀种</p></li>
</ol>
<p>结果上：</p>
<ol class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">def</span></code> 语句一定会增加⼀个函数名称</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">lambda</span></code> 不会，这就降低了了变量名污染的⻛险</p></li>
</ol>
<p><strong>能用一个表达式直接放到 return 里返回的函数都可以⽤ lambda 速写</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">multiply</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">a</span> <span class="o">*</span> <span class="n">b</span>

<span class="n">multiply_by_lambda</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">:</span> <span class="n">x</span> <span class="o">*</span> <span class="n">y</span>
</pre></div>
</div>
<p>List + lambda 可以得到⾏为列表</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">f_list</span> <span class="o">=</span> <span class="p">[</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">**</span> <span class="mi">2</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">**</span> <span class="mi">3</span><span class="p">]</span> 
<span class="p">[</span><span class="n">f_list</span><span class="p">[</span><span class="n">j</span><span class="p">](</span><span class="mi">10</span><span class="p">)</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)]</span> 
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[11, 100, 1000]
</pre></div>
</div>
<blockquote>
<div><p>在 AI 领域里，这种写法常用于处理数据，比如按预定的⼀系列模式处理数据</p>
</div></blockquote>
<p>下面我们以两个例子来结束高阶函数：</p>
<p>例1：</p>
<hr class="docutils" />
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">L</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>

<span class="c1"># 计算l中每个元素的两倍和平方，并将两种组成一个列表</span>
<span class="c1"># lambda表达式和python函数一样，也可以接受函数作为参数</span>


<span class="k">def</span> <span class="nf">twoTimes</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">x</span> <span class="o">*</span> <span class="mi">2</span>


<span class="k">def</span> <span class="nf">square</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span>


<span class="nb">print</span><span class="p">([</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">(</span><span class="n">i</span><span class="p">),</span> <span class="p">[</span><span class="n">twoTimes</span><span class="p">,</span> <span class="n">square</span><span class="p">]))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">L</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="n">L</span><span class="p">)))</span>

<span class="c1"># 内置reduce函数，计算 L 的和</span>
<span class="nb">print</span><span class="p">(</span><span class="n">reduce</span><span class="p">(</span><span class="k">lambda</span> <span class="n">accumValue</span><span class="p">,</span> <span class="n">newValue</span><span class="p">:</span> <span class="n">accumValue</span> <span class="o">+</span> <span class="n">newValue</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[[0, 0], [2, 1], [4, 4], [6, 9], [8, 16], [10, 25]]
[0, 2, 4]
15
</pre></div>
</div>
<p>我们依然可以使用列表解析的方式替换 <code class="docutils literal notranslate"><span class="pre">map</span></code> &amp; <code class="docutils literal notranslate"><span class="pre">filter</span></code>：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">[[</span><span class="n">twoTimes</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">square</span><span class="p">(</span><span class="n">x</span><span class="p">)]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">L</span><span class="p">]</span>

<span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">L</span> <span class="k">if</span> <span class="n">x</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
<hr class="docutils" />
<p>通过上面的例子我们发现，使用列表推导要比 map 与 filter 简洁且易于理解得多。</p>
<p>但是，我们这里还有一个<strong>惰性计算</strong>的坑：</p>
<hr class="docutils" />
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">f_list</span> <span class="o">=</span> <span class="p">[</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span><span class="n">x</span><span class="o">**</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">)]</span>

<span class="p">[</span><span class="n">f_list</span><span class="p">[</span><span class="n">j</span><span class="p">](</span><span class="mi">3</span><span class="p">)</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">)]</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[81, 81, 81, 81, 81]
</pre></div>
</div>
<hr class="docutils" />
<p>大家可以思考为什么会出现这个意想不到的结果？</p>
</div>
</div>
</div>
<hr class="docutils" />
<div class="section" id="decorator">
<h3>函数修饰器（Decorator）其他相关知识<a class="headerlink" href="#decorator" title="永久链接至标题">¶</a></h3>
<p>Python中的函数是对象,故函数可以被当做变量使用。</p>
<p>参考资料：</p>
<ul class="simple">
<li><p><a class="reference external" href="http://coolshell.cn/articles/11265.html">Python修饰器的函数式编程</a></p></li>
<li><p><a class="reference external" href="http://www.cnblogs.com/huxi/archive/2011/03/01/1967600.html">Python装饰器与面向切面编程</a></p></li>
<li><p><a class="reference external" href="http://www.open-open.com/lib/view/open1395285030019.html">Python修饰器的函数式编程</a></p></li>
</ul>
</div>
</div>
<div class="section" id="id22">
<h2>作用：<a class="headerlink" href="#id22" title="永久链接至标题">¶</a></h2>
<p>对已有的函数添加一些小功能，却又不希望对函数内容有太多的刚性的修改。</p>
<ul class="simple">
<li><p>将需要添加功能的函数像普通对象一样作为参数传入修饰器在中；</p></li>
<li><p>将函数作为修饰器的返回值返回。</p></li>
</ul>
<p>修饰器的本质： Python解释器在发现函数调用修饰器后，将其传入修饰器中，然后用返回的函数对象将自身完全替换。</p>
<p>一个函数可以被多个修饰器嵌套修饰：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@deco3</span>
<span class="nd">@deco2</span>
<span class="nd">@deco1</span>
<span class="k">def</span> <span class="nf">df</span><span class="p">():</span>
    <span class="k">pass</span>
</pre></div>
</div>
<p>等同于 <code class="docutils literal notranslate"><span class="pre">f=deco3(deco2(deco1(f)))</span></code></p>
</div>
<div class="section" id="id23">
<h2>示例<a class="headerlink" href="#id23" title="永久链接至标题">¶</a></h2>
<div class="section" id="hello-world">
<h3>添加水印 <code class="docutils literal notranslate"><span class="pre">Hello</span> <span class="pre">World_</span></code><a class="headerlink" href="#hello-world" title="永久链接至标题">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">deco</span><span class="p">(</span><span class="n">func</span><span class="p">):</span>          <span class="c1">#修饰器deco</span>
    <span class="k">def</span> <span class="nf">wrappedFunc</span><span class="p">():</span>          <span class="c1">#内嵌函数wrappedFunc(所有对于传入函数的修饰逻辑都将在此内嵌函数中实现。)</span>
        <span class="k">return</span> <span class="s1">&#39;Hello World_&#39;</span><span class="o">+</span><span class="n">func</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">wrappedFunc</span>

<span class="c1"># 在程序中若有函数需要修饰器修饰，只需在函数定义前使用“`@+修饰器名`”即可使用此修饰器。</span>
<span class="nd">@deco</span>
<span class="k">def</span> <span class="nf">f</span><span class="p">():</span>    <span class="c1"># 调用修饰器</span>
    <span class="k">return</span> <span class="s1">&#39;I am f&#39;</span>
<span class="k">def</span> <span class="nf">g</span><span class="p">():</span>     <span class="c1"># 没有调用修饰器</span>
    <span class="k">return</span> <span class="s1">&#39;I am g&#39;</span>

<span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">g</span><span class="p">())</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Hello World_I am f
I am g
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">deco</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">g</span><span class="p">():</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">f</span><span class="p">()[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">)]</span>
    <span class="k">return</span> <span class="n">g</span>
<span class="nd">@deco</span>
<span class="k">def</span> <span class="nf">h</span><span class="p">():</span>
    <span class="k">return</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">56</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="s1">&#39;75s&#39;</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">h</span><span class="p">())</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[1, 2, 3, 4, 56]
</pre></div>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "xinetzone/d2py",
            ref: "main",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./python-study\drafts"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>
<div class="section">
   
</div>

              </div>
              
        
            <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="66.html" title="上一页 页">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">上一页</p>
            <p class="prev-next-title">类型和运算 (Types and Operations)</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="class.html" title="下一页 页">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">下一页</p>
        <p class="prev-next-title">class</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
        
        </div>
    </div>
    <footer class="footer">
    <div class="container">
      <p>
        
          By xinetzone<br/>
        
            &copy; Copyright 2021, xinetzone.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>